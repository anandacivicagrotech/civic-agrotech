# 🔄 Farm Alert Logger & AI Assistant - User Flows
**ระบบบันทึกการแจ้งเตือนฟาร์มและ AI ผู้ช่วย**  
**วันที่:** 10 พฤศจิกายน 2025

---

## 📋 ภาพรวม User Flows

เอกสารนี้อธิบาย user flows สำหรับผู้ใช้งานหลัก 3 กลุ่ม:
1. **ผู้จัดการฟาร์ม** - ดูภาพรวม log และแนวโน้ม
2. **ทีมบำรุงรักษา** - ค้นหาประวัติปัญหาและแก้ไข
3. **ทีมเทคนิค** - วิเคราะห์ปัญหาที่เกิดซ้ำ

---

## 👨‍💼 Flow 1: ผู้จัดการฟาร์ม - ดูภาพรวม Log และแนวโน้ม

### 🎯 เป้าหมาย
ดูภาพรวมการแจ้งเตือนทั้งหมด เข้าใจสถานการณ์ปัจจุบัน และหาแนวโน้มปัญหา

### 📝 Steps

#### 1. เข้าสู่ระบบและดู Dashboard
```
เปิด web app → Login
↓
หน้าแรก (Dashboard) แสดง:
  📊 สรุปการแจ้งเตือนวันนี้
  ⚠️ การแจ้งเตือนล่าสุด (Real-time)
  📈 กราฟแนวโน้ม 7 วัน
  🔴 ปัญหาที่ยังไม่แก้ไข
```


#### 2. ดูสรุปการแจ้งเตือนวันนี้
```
Dashboard แสดง Cards:

┌─────────────────────────┐
│ 📊 สรุปวันนี้           │
│ ทั้งหมด: 23 รายการ      │
│ 🔴 Critical: 2          │
│ 🟡 Warning: 8           │
│ 🟢 Info: 13             │
└─────────────────────────┘

┌─────────────────────────┐
│ 🏆 อุปกรณ์ที่มีปัญหา   │
│ 1. ปั๊ม A: 5 ครั้ง     │
│ 2. pH Sensor: 4 ครั้ง  │
│ 3. ปั๊ม B: 3 ครั้ง     │
└─────────────────────────┘
```

#### 3. ดูการแจ้งเตือนล่าสุด (Real-time)
```
Timeline แสดง log ล่าสุด:

⏰ 14:35 | 🔴 pH เกิน 7.5 | Zone A
⏰ 14:20 | 🟡 ปั๊ม A ทำงานนาน | Zone B
⏰ 13:45 | 🟢 EC ปกติ | Zone A
⏰ 13:30 | 🔴 อุณหภูมิสูง 32°C | Zone C
...

คลิกที่ log → เห็นรายละเอียด:
  - เวลาที่เกิด
  - อุปกรณ์
  - ค่าที่วัดได้
  - สถานะ (แก้ไขแล้ว/ยังไม่แก้)
```


#### 4. ดูกราฟแนวโน้ม
```
แท็บ "แนวโน้ม" → เห็นกราฟ:

📈 กราฟจำนวนการแจ้งเตือนต่อวัน (7 วัน)
   จ   อ   พ   พฤ  ศ   ส   อา
   15  12  18  25  20  16  23  ← วันพฤหัสมีปัญหามากสุด!

📈 Heatmap ช่วงเวลาที่มีปัญหา
   00-06: 🟢 น้อย
   06-12: 🟡 ปานกลาง
   12-18: 🔴 มาก ← ช่วงบ่ายมีปัญหาบ่อย
   18-24: 🟢 น้อย

📈 กราฟแยกตามประเภท
   - pH เกิน: 40%
   - อุณหภูมิสูง: 25%
   - ปั๊มทำงานนาน: 20%
   - อื่น ๆ: 15%
```

#### 5. ดูปัญหาที่ยังไม่แก้ไข
```
แท็บ "ยังไม่แก้ไข" → เห็นรายการ:

🔴 pH เกิน 7.5 | Zone A | 2 ชม. ที่แล้ว
   [มอบหมาย] [แก้ไขแล้ว]

🔴 อุณหภูมิสูง 32°C | Zone C | 45 นาที ที่แล้ว
   [มอบหมาย] [แก้ไขแล้ว]

คลิก [มอบหมาย] → เลือกคนที่จะแก้ไข
คลิก [แก้ไขแล้ว] → ระบุวิธีแก้และปิด log
```

### ✅ ผลลัพธ์
- เห็นภาพรวมปัญหาทั้งหมด
- รู้ว่าอุปกรณ์ไหนมีปัญหาบ่อย
- เห็นแนวโน้มและช่วงเวลาที่มีปัญหา
- สามารถมอบหมายงานแก้ไขได้


---

## 🔧 Flow 2: ทีมบำรุงรักษา - ค้นหาประวัติปัญหาและแก้ไข

### 🎯 เป้าหมาย
ค้นหาประวัติปัญหาของอุปกรณ์ เพื่อแก้ไขและบันทึกวิธีแก้

### 📝 Steps

#### 1. รับการแจ้งเตือนจาก LINE
```
LINE OA ส่งข้อความ:
"🔴 ปั๊ม A ทำงานนาน 
Zone B | 14:20 | ดูรายละเอียด: [Link]"
↓
คลิก [Link] → เปิด web app
```

#### 2. ดูรายละเอียดปัญหา
```
หน้ารายละเอียด log แสดง:

⚠️ ปั๊ม A ทำงานนาน
📍 Zone: B
⏰ เวลา: 14:20
📊 ระยะเวลาทำงาน: 45 นาที (ปกติ 15-20 นาที)
🔴 สถานะ: ยังไม่แก้ไข

[ดูประวัติปั๊ม A] [บันทึกการแก้ไข]
```

#### 3. ดูประวัติปัญหาของอุปกรณ์
```
คลิก [ดูประวัติปั๊ม A]
↓
เห็นประวัติทั้งหมด:

📅 10/11/2025 14:20 - ทำงานนาน 45 นาที (กำลังแก้)
📅 08/11/2025 09:15 - ทำงานนาน 50 นาที (แก้แล้ว)
   └─ วิธีแก้: ทำความสะอาดฟิลเตอร์
📅 05/11/2025 16:30 - ทำงานนาน 40 นาที (แก้แล้ว)
   └─ วิธีแก้: ตรวจสอบท่อ พบอุดตัน

💡 AI แนะนำ: "ปั๊ม A มีปัญหาทุก 2-3 วัน 
อาจต้องเช็คระบบกรองน้ำ"
```


#### 4. แก้ไขปัญหาและบันทึก
```
ไปแก้ไขที่ฟาร์ม:
  - ตรวจสอบปั๊ม A
  - พบว่าฟิลเตอร์อุดตัน
  - ทำความสะอาดฟิลเตอร์
  - ทดสอบปั๊มทำงานปกติ
↓
กลับมาบันทึกในระบบ:

คลิก [บันทึกการแก้ไข]
↓
กรอกข้อมูล:
  ✅ สถานะ: แก้ไขแล้ว
  📝 วิธีแก้: "ทำความสะอาดฟิลเตอร์ พบสิ่งสกปรกอุดตัน"
  ⏰ เวลาที่ใช้: 15 นาที
  📷 รูปภาพ: [อัพโหลดรูปฟิลเตอร์]
  💡 หมายเหตุ: "ควรเช็คฟิลเตอร์ทุกสัปดาห์"
↓
กด "บันทึก"
```

#### 5. ระบบส่งการแจ้งเตือนกลับ
```
ระบบส่ง LINE ไปหาผู้จัดการ:
"✅ ปั๊ม A แก้ไขเรียบร้อย
โดย: สมชาย
วิธีแก้: ทำความสะอาดฟิลเตอร์
เวลา: 15 นาที"
```

### ✅ ผลลัพธ์
- ค้นหาประวัติปัญหาได้ง่าย
- เห็นวิธีแก้ไขครั้งก่อน ๆ
- บันทึกวิธีแก้ไว้ใช้ต่อ
- ทีมอื่นเห็นข้อมูลเดียวกัน


---

## 🤖 Flow 3: ใช้ AI Assistant ถาม-ตอบ

### 🎯 เป้าหมาย
ถามคำถามเกี่ยวกับ log และได้คำตอบทันที

### 📝 Steps

#### 1. เปิด AI Chat
```
Dashboard → คลิกปุ่ม "💬 ถาม AI"
↓
เปิดหน้าต่าง Chat
```

#### 2. ถามคำถามพื้นฐาน
```
👤 User: "pH เกินกี่ครั้งในสัปดาห์นี้?"
↓
🤖 AI: "pH เกินทั้งหมด 12 ครั้งในสัปดาห์นี้
- วันจันทร์: 2 ครั้ง
- วันอังคาร: 1 ครั้ง
- วันพุธ: 3 ครั้ง
- วันพฤหัสบดี: 4 ครั้ง ⚠️ มากสุด
- วันศุกร์: 2 ครั้ง

💡 สังเกต: วันพฤหัสมีปัญหามากกว่าปกติ"
```

#### 3. ถามเกี่ยวกับอุปกรณ์
```
👤 User: "ปั๊ม A มีปัญหาเมื่อไหร่บ้าง?"
↓
🤖 AI: "ปั๊ม A มีปัญหา 5 ครั้งในเดือนนี้:

1. 10/11 14:20 - ทำงานนาน (แก้แล้ว)
2. 08/11 09:15 - ทำงานนาน (แก้แล้ว)
3. 05/11 16:30 - ทำงานนาน (แก้แล้ว)
4. 02/11 11:45 - ไม่ทำงาน (แก้แล้ว)
5. 01/11 08:00 - ทำงานนาน (แก้แล้ว)

📊 ความถี่: ทุก 2-3 วัน
⚠️ คำแนะนำ: ควรตรวจสอบระบบกรองน้ำ"
```


#### 4. ถามเปรียบเทียบ
```
👤 User: "อุปกรณ์ไหนมีปัญหาบ่อยที่สุด?"
↓
🤖 AI: "อุปกรณ์ที่มีปัญหาบ่อยที่สุดในเดือนนี้:

1. 🥇 ปั๊ม A: 5 ครั้ง
2. 🥈 pH Sensor: 4 ครั้ง
3. 🥉 ปั๊ม B: 3 ครั้ง
4. EC Sensor: 2 ครั้ง
5. อุณหภูมิ Sensor: 1 ครั้ง

💡 แนะนำ: ควรตรวจสอบปั๊ม A และ pH Sensor 
เนื่องจากมีปัญหาบ่อยกว่าปกติ"
```

#### 5. ถามวิธีแก้ปัญหา
```
👤 User: "แนะนำวิธีแก้ pH เกิน"
↓
🤖 AI: "วิธีแก้ pH เกินจากประวัติที่เคยทำ:

✅ วิธีที่ 1: เติม pH Down
   - ใช้เวลา: 5-10 นาที
   - ใช้บ่อย: 8 ครั้ง
   - ประสิทธิภาพ: 90%

✅ วิธีที่ 2: ตรวจสอบระบบผสมปุ๋ย
   - ใช้เวลา: 15-20 นาที
   - ใช้บ่อย: 3 ครั้ง
   - ประสิทธิภาพ: 100%

💡 คำแนะนำ: ถ้า pH เกินบ่อย ๆ ควรตรวจสอบ
ระบบผสมปุ๋ยด้วย อาจมีปัญหาที่ต้นเหตุ"
```

### ✅ ผลลัพธ์
- ได้คำตอบทันที ไม่ต้องค้นหาเอง
- เห็นแนวโน้มและสถิติ
- ได้คำแนะนำจากประวัติ
- ประหยัดเวลาในการวิเคราะห์


---

## 🔍 Flow 4: ทีมเทคนิค - วิเคราะห์ปัญหาที่เกิดซ้ำ

### 🎯 เป้าหมาย
หาปัญหาที่เกิดซ้ำและหาสาเหตุหลัก

### 📝 Steps

#### 1. เข้าหน้าวิเคราะห์
```
Dashboard → แท็บ "วิเคราะห์"
```

#### 2. ดูปัญหาที่เกิดซ้ำ
```
ระบบแสดง:

🔄 ปัญหาที่เกิดซ้ำ (30 วันที่แล้ว)

1. pH เกิน - 45 ครั้ง
   📊 แนวโน้ม: เพิ่มขึ้น 20%
   ⏰ ช่วงเวลา: 12:00-16:00 (บ่าย)
   📍 Zone: A (มากสุด)
   [ดูรายละเอียด]

2. ปั๊ม A ทำงานนาน - 15 ครั้ง
   📊 แนวโน้ม: คงที่
   ⏰ ช่วงเวลา: ทุกช่วงเวลา
   📍 Zone: B
   [ดูรายละเอียด]

3. อุณหภูมิสูง - 12 ครั้ง
   📊 แนวโน้ม: เพิ่มขึ้น 50%
   ⏰ ช่วงเวลา: 13:00-15:00
   📍 Zone: C
   [ดูรายละเอียด]
```

#### 3. วิเคราะห์รายละเอียด
```
คลิก [ดูรายละเอียด] ที่ "pH เกิน"
↓
เห็นกราฟและข้อมูล:

📈 กราฟ pH เกินต่อวัน (30 วัน)
   [กราฟแสดงแนวโน้มเพิ่มขึ้น]

📊 แยกตาม Zone:
   - Zone A: 25 ครั้ง (55%)
   - Zone B: 12 ครั้ง (27%)
   - Zone C: 8 ครั้ง (18%)

⏰ แยกตามช่วงเวลา:
   - 00-06: 2 ครั้ง
   - 06-12: 8 ครั้ง
   - 12-18: 30 ครั้ง ⚠️ มากสุด
   - 18-24: 5 ครั้ง

💡 AI วิเคราะห์:
"pH เกินมักเกิดช่วงบ่าย (12-18 น.) ใน Zone A
อาจเกี่ยวข้องกับอุณหภูมิสูงในช่วงเวลาเดียวกัน
แนะนำตรวจสอบระบบระบายความร้อน"
```


#### 4. หาความสัมพันธ์ระหว่างปัญหา
```
แท็บ "ความสัมพันธ์"
↓
ระบบแสดง:

🔗 ปัญหาที่เกิดพร้อมกัน

"pH เกิน" มักเกิดพร้อมกับ:
  - อุณหภูมิสูง (80% ของครั้ง)
  - EC สูง (45% ของครั้ง)

💡 AI แนะนำ:
"pH เกินมักเกิดเมื่ออุณหภูมิสูง
แนะนำติดตั้งระบบระบายความร้อนอัตโนมัติ
หรือปรับเวลาผสมปุ๋ยเป็นช่วงเช้า"
```

#### 5. Export รายงาน
```
กดปุ่ม "Export รายงาน"
↓
เลือกรูปแบบ:
  [ ] PDF Report
  [ ] Excel (.xlsx)
  [ ] CSV (สำหรับวิเคราะห์ต่อ)
↓
เลือกข้อมูล:
  [✓] สรุปปัญหาที่เกิดซ้ำ
  [✓] กราฟแนวโน้ม
  [✓] การวิเคราะห์ของ AI
  [✓] คำแนะนำ
↓
กด "Download"
```

### ✅ ผลลัพธ์
- เห็นปัญหาที่เกิดซ้ำชัดเจน
- เข้าใจแนวโน้มและสาเหตุ
- ได้คำแนะนำจาก AI
- Export รายงานไปใช้ต่อได้


---

## 📱 Flow 5: ใช้งานผ่าน LINE Bot

### 🎯 เป้าหมาย
ถาม-ตอบและดูข้อมูลผ่าน LINE โดยไม่ต้องเปิด web

### 📝 Steps

#### 1. เปิดแชท LINE Bot
```
เปิด LINE → เลือก "Farm Alert Bot"
```

#### 2. ถามคำถามผ่าน LINE
```
👤 User: "pH เกินกี่ครั้งวันนี้?"
↓
🤖 Bot: "pH เกินวันนี้ 3 ครั้ง
- 09:30 Zone A (แก้แล้ว)
- 13:45 Zone A (แก้แล้ว)
- 15:20 Zone C (กำลังแก้)

ดูรายละเอียด: [Link]"
```

#### 3. ขอสรุปรายวัน
```
👤 User: "สรุปวันนี้"
↓
🤖 Bot: "📊 สรุปวันนี้ (10/11/2025)

ทั้งหมด: 23 รายการ
🔴 Critical: 2
🟡 Warning: 8
🟢 Info: 13

อุปกรณ์ที่มีปัญหา:
1. ปั๊ม A: 5 ครั้ง
2. pH Sensor: 4 ครั้ง

ดู Dashboard: [Link]"
```

#### 4. ขอคำแนะนำ
```
👤 User: "แนะนำแก้ปั๊ม A"
↓
🤖 Bot: "วิธีแก้ปั๊ม A จากประวัติ:

✅ ทำความสะอาดฟิลเตอร์
   ใช้บ่อย: 8 ครั้ง
   ประสิทธิภาพ: 90%

✅ ตรวจสอบท่อ
   ใช้บ่อย: 3 ครั้ง
   ประสิทธิภาพ: 100%

ดูรายละเอียด: [Link]"
```

### ✅ ผลลัพธ์
- ถาม-ตอบได้ทุกที่ผ่าน LINE
- ไม่ต้องเปิด web app
- ได้คำตอบทันที
- สะดวกสำหรับงานด่วน


---

## 🔄 Flow Summary

### การไหลของข้อมูล (Data Flow):
```
Controller → ส่ง log ไป LINE OA
    ↓
Webhook → รับข้อความจาก LINE
    ↓
Parser → แยก device, alert type, value
    ↓
Database → เก็บข้อมูล
    ↓
Analysis → วิเคราะห์แนวโน้ม
    ↓
AI → ตอบคำถาม + แนะนำ
    ↓
Dashboard/LINE Bot → แสดงผลให้ผู้ใช้
```

### เวลาที่ใช้ในแต่ละ Flow:

| Flow | เวลาที่ใช้ | ความถี่ |
|------|-----------|---------|
| ดูภาพรวม Dashboard | 2-3 นาที | ทุกวัน |
| ค้นหาประวัติและแก้ไข | 5-10 นาที | เมื่อมีปัญหา |
| ถาม AI | 30 วินาที - 1 นาที | ตามต้องการ |
| วิเคราะห์ปัญหาซ้ำ | 10-15 นาที | สัปดาห์ละ 1 ครั้ง |
| ใช้ LINE Bot | 30 วินาที | ทุกวัน |

### เปรียบเทียบก่อน-หลัง:

| งาน | ก่อนใช้ระบบ | หลังใช้ระบบ | ประหยัด |
|-----|-------------|-------------|---------|
| ค้นหา log เก่า | 10 นาที (เลื่อนแชท) | 1 นาที (ค้นหา) | 90% |
| หาสาเหตุปัญหา | 20 นาที | 5 นาที | 75% |
| วิเคราะห์แนวโน้ม | ไม่มี | 10 นาที | - |
| ถาม-ตอบ | ต้องถามคน | 30 วินาที (AI) | 95% |

---

## 💡 Key Features ที่ต้องมี

### Must Have (4-6 สัปดาห์):
- ✅ เก็บ log จาก LINE Webhook
- ✅ Dashboard แสดงภาพรวม
- ✅ ค้นหา log เก่า
- ✅ AI ตอบคำถามพื้นฐาน
- ✅ กราฟแนวโน้ม

### Should Have:
- ✅ วิเคราะห์ปัญหาที่เกิดซ้ำ
- ✅ หาความสัมพันธ์ระหว่างปัญหา
- ✅ LINE Bot สำหรับถาม-ตอบ
- ✅ บันทึกวิธีแก้ปัญหา

### Could Have:
- ⭕ Predictive Analytics (ทำนายปัญหา)
- ⭕ Auto-assign งานแก้ไข
- ⭕ Mobile App
- ⭕ Integration กับ FMS

---

**สรุป:** User flows ครอบคลุมการใช้งานหลักทั้งหมด ตั้งแต่การดูภาพรวม ค้นหาประวัติ ถาม AI ไปจนถึงการวิเคราะห์ปัญหาที่เกิดซ้ำ โดยเน้นความรวดเร็วและง่ายต่อการใช้งาน

---

**Last Updated:** 10 พฤศจิกายน 2025
