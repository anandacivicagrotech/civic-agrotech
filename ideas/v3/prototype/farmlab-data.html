<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FarmLab - ‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏ü‡∏≤‡∏£‡πå‡∏°</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #43cea2 0%, #185a9d 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            background: white;
            padding: 25px 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 25px;
        }

        h1 {
            color: #333;
            font-size: 2rem;
            margin-bottom: 5px;
        }

        .subtitle {
            color: #666;
            font-size: 0.95rem;
        }

        .tab-nav {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .tab-button {
            padding: 12px 24px;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.3s;
            color: #666;
        }

        .tab-button:hover {
            border-color: #43cea2;
            color: #43cea2;
        }

        .tab-button.active {
            background: #43cea2;
            color: white;
            border-color: #43cea2;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .settings-dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-menu {
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            z-index: 1000;
            min-width: 180px;
            margin-top: 5px;
        }

        .dropdown-menu.show {
            display: block;
        }

        .dropdown-menu button {
            display: block;
            width: 100%;
            padding: 12px 20px;
            border: none;
            background: none;
            text-align: left;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            color: #666;
            transition: all 0.3s;
        }

        .dropdown-menu button:hover {
            background: #f8f9fa;
            color: #43cea2;
        }

        .dropdown-menu button:first-child {
            border-radius: 8px 8px 0 0;
        }

        .dropdown-menu button:last-child {
            border-radius: 0 0 8px 8px;
        }

        .card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .card h2 {
            color: #333;
            font-size: 1.3rem;
            margin-bottom: 20px;
        }

        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .project-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .project-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .project-card h3 {
            color: #43cea2;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .project-meta {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            font-size: 0.9em;
            color: #666;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .badge.green {
            background: #d4edda;
            color: #155724;
        }

        .badge.active {
            background: #d4edda;
            color: #155724;
        }

        .btn {
            padding: 12px 30px;
            background: #43cea2;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn:hover {
            background: #3ab890;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(67, 206, 162, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .back-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            margin-bottom: 20px;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-block;
        }

        .back-btn:hover {
            background: #5a6268;
            transform: translateY(-2px);
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        label {
            color: #555;
            font-size: 0.9rem;
            font-weight: 600;
        }

        input, select, textarea {
            padding: 10px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 0.95rem;
            outline: none;
            transition: border-color 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            border-color: #43cea2;
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        .image-upload {
            border: 2px dashed #e0e0e0;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .image-upload:hover {
            border-color: #43cea2;
            background: #f8fff8;
        }

        .image-upload input {
            display: none;
        }

        .image-preview {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .image-preview img {
            width: 120px;
            height: 120px;
            object-fit: cover;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
        }

        .chart-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }

        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .chart-container h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .template-fields {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }

        .field-item {
            background: white;
            padding: 10px 15px;
            border-radius: 6px;
            margin-bottom: 8px;
        }

        .view-container {
            display: none;
        }

        .view-container.active {
            display: block;
        }

        .sensor-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #43cea2;
            margin: 10px 0;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #666;
        }

        @media (max-width: 1024px) {
            .form-grid {
                grid-template-columns: 1fr;
            }

            .chart-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            .projects-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üß™ FarmLab</h1>
        </header>

        <div class="tab-nav">
            <button class="tab-button active" onclick="showTab('projects')">üìã Projects - ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</button>
            <button class="tab-button" onclick="showTab('collect')">üìù Data Entry - ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
            <button class="tab-button" onclick="showTab('sensors')">üìä Dashboard - ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</button>
            <div class="settings-dropdown">
                <button class="tab-button" onclick="toggleSettings()">‚öôÔ∏è Settings - ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
                <div class="dropdown-menu" id="settingsMenu">
                    <button onclick="showTemplates()">üìù Templates - ‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö</button>
                </div>
            </div>
        </div>

        <!-- Tab 1: ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ -->
        <div id="projects" class="tab-content active">
            <div id="projectsListView" class="view-container active">
                <div class="card">
                    <h2>üìã ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏à‡∏±‡∏¢ (Project Management)</h2>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; margin-top: 20px;">
                        <h3 style="margin: 0;">‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                        <button class="btn" onclick="showCreateProject()">+ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà</button>
                    </div>
                    <div class="projects-grid" id="projectsGrid"></div>
                </div>
            </div>

            <!-- Create Project View -->
            <div id="createProjectView" class="view-container">
                <div class="card">
                    <button class="back-btn" onclick="showProjectsList()">‚Üê ‡∏Å‡∏•‡∏±‡∏ö</button>
                    <h2>‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà</h2>
                    <form id="projectForm" onsubmit="createProject(event)">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</label>
                                <input type="text" id="projectName" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ú‡∏±‡∏Å‡∏Å‡∏≤‡∏î‡∏´‡∏≠‡∏°" required>
                            </div>
                            <div class="form-group">
                                <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≠‡∏ö</label>
                                <input type="number" id="projectRounds" placeholder="‡πÄ‡∏ä‡πà‡∏ô 3" min="1" required>
                            </div>
                            <div class="form-group">
                                <label>‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö (‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡∏à‡∏±‡∏¢)</label>
                                <input type="text" id="projectOwner" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡∏à‡∏±‡∏¢" required>
                            </div>
                            <div class="form-group">
                                <label>‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏ô</label>
                                <select id="projectGreenhouse" required>
                                    <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏ô --</option>
                                    <option value="No.1">üè† No.1</option>
                                    <option value="Lab A">üî¨ Lab A</option>
                                    <option value="Blue Room">üîµ Blue Room</option>
                                </select>
                            </div>
                            <div class="form-group full-width">
                                <label>‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</label>
                                <textarea id="projectDesc" placeholder="‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á"></textarea>
                            </div>
                            <div class="form-group full-width">
                                <label>‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö (‡∏à‡∏≤‡∏Å Template)</label>
                                <div class="template-fields" id="templateFieldsPreview">
                                    <div class="field-item">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á (cm)</div>
                                    <div class="field-item">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÉ‡∏ö</div>
                                    <div class="field-item">‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏ö (cm)</div>
                                    <div class="field-item">‡∏™‡∏µ‡πÉ‡∏ö</div>
                                    <div class="field-item">‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (g)</div>
                                </div>
                            </div>
                        </div>
                        <div style="margin-top: 30px; display: flex; gap: 15px;">
                            <button type="submit" class="btn">‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</button>
                            <button type="button" class="btn btn-secondary" onclick="showProjectsList()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Project Detail View -->
            <div id="projectDetailView" class="view-container">
                <div class="card">
                    <button class="back-btn" onclick="showProjectsList()">‚Üê ‡∏Å‡∏•‡∏±‡∏ö</button>
                    <div id="projectDetailContent"></div>
                </div>
            </div>
        </div>

        <!-- Tab 2: ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
        <div id="collect" class="tab-content">
            <div class="card">
                <h2>üìù ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Data Recording)</h2>
                <p style="color: #666; margin-bottom: 20px;">
                    <strong>‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ:</strong> ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≠‡∏ö ‚Üí ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏° template ‚Üí ‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ ‚Üí ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ) ‚Üí Save<br>
                    <strong>‡∏Ç‡πâ‡∏≠‡∏î‡∏µ:</strong> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡πá‡∏ß ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏≠ OneDrive ‡∏ä‡πâ‡∏≤ ‡πÜ ‡∏°‡∏µ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏π‡∏õ (3-5 ‡∏£‡∏π‡∏õ) ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö AI
                </p>
                <form id="dataForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</label>
                            <select id="dataProject" onchange="updateDataRounds()" required>
                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>‡∏£‡∏≠‡∏ö</label>
                            <select id="dataRound" required>
                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≠‡∏ö</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</label>
                            <input type="date" id="dataDate" required>
                        </div>
                        <div class="form-group">
                            <label>‡∏£‡∏∞‡∏¢‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï</label>
                            <select id="dataStage" required>
                                <option value="germination">‡πÄ‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏•‡πá‡∏î</option>
                                <option value="seedling">‡∏ï‡πâ‡∏ô‡∏Å‡∏•‡πâ‡∏≤</option>
                                <option value="vegetative">‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï</option>
                                <option value="mature">‡πÇ‡∏ï‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà</option>
                                <option value="harvest">‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß</option>
                            </select>
                        </div>

                        <!-- Template Fields -->
                        <div class="form-group full-width" style="background: #f8f9fa; padding: 20px; border-radius: 8px;">
                            <h3 style="margin-bottom: 15px;">üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏° Template</h3>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á (cm)</label>
                                    <input type="number" step="0.1" id="dataHeight" placeholder="‡πÄ‡∏ä‡πà‡∏ô 15.5">
                                </div>
                                <div class="form-group">
                                    <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÉ‡∏ö</label>
                                    <input type="number" id="dataLeafCount" placeholder="‡πÄ‡∏ä‡πà‡∏ô 8">
                                </div>
                                <div class="form-group">
                                    <label>‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏ö (cm)</label>
                                    <input type="number" step="0.1" id="dataLeafSize" placeholder="‡πÄ‡∏ä‡πà‡∏ô 5.2">
                                </div>
                                <div class="form-group">
                                    <label>‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (g)</label>
                                    <input type="number" step="0.1" id="dataWeight" placeholder="‡πÄ‡∏ä‡πà‡∏ô 185.5">
                                </div>
                            </div>
                        </div>

                        <div class="form-group full-width">
                            <label>‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (2-5 ‡∏£‡∏π‡∏õ)</label>
                            <div class="image-upload" onclick="document.getElementById('dataImages').click()">
                                <input type="file" id="dataImages" accept="image/*" multiple onchange="previewDataImages(event)">
                                <p>üì∑ ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</p>
                                <p style="font-size: 0.85rem; color: #999; margin-top: 10px;">‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡πÑ‡∏î‡πâ</p>
                            </div>
                            <div class="image-preview" id="dataImagePreview"></div>
                        </div>

                        <div class="form-group full-width">
                            <label>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡∏ñ‡πâ‡∏≤‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏û‡∏¥‡πÄ‡∏®‡∏©)</label>
                            <textarea id="dataNotes" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏û‡∏ö‡πÉ‡∏ö‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á rack 3, ‡πÉ‡∏ö‡πÑ‡∏´‡∏°‡πâ, ‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏≠‡∏∑‡πà‡∏ô ‡πÜ"></textarea>
                        </div>
                    </div>
                    <div style="margin-top: 30px; display: flex; gap: 15px;">
                        <button type="submit" class="btn">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                        <button type="reset" class="btn btn-secondary">üîÑ ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Tab 3: Dashboard (Sensors) -->
        <div id="sensors" class="tab-content">
            <div class="card">
                <h2>üìä Dashboard - ‡πÄ‡∏ã‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå IoT</h2>
                <p style="color: #666; margin-bottom: 20px;">
                    <strong>‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£:</strong> ‡πÄ‡∏ã‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• pH, EC, ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ ‡∏°‡∏≤‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡∏ä‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏µ‡∏¢‡∏ß<br>
                    <strong>‡∏Ç‡πâ‡∏≠‡∏î‡∏µ:</strong> ‡∏î‡∏π‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏£‡∏≤‡∏ü ‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏î‡πâ ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ä‡πâ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏•‡∏∞‡∏ó‡∏≥ AI ‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏õ‡∏î‡∏π‡∏´‡∏•‡∏≤‡∏¢‡∏ó‡∏µ‡πà
                </p>
            </div>

            <!-- Greenhouse Selection Cards -->
            <div class="card">
                <h3 style="margin-bottom: 15px;">üè† ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏ô</h3>
                <div class="projects-grid" id="greenhouseCards">
                    <div class="project-card" onclick="selectGreenhouse('no1')" id="card-no1">
                        <h3>üè† No.1</h3>
                        <p style="color: #666; margin: 10px 0;">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏Å - ‡∏ú‡∏±‡∏Å‡∏™‡∏•‡∏±‡∏î</p>
                        <div class="project-meta">
                            <span class="badge green">‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</span>
                        </div>
                    </div>
                    <div class="project-card" onclick="selectGreenhouse('laba')" id="card-laba">
                        <h3>üî¨ Lab A</h3>
                        <p style="color: #666; margin: 10px 0;">Lab ‡∏ó‡∏î‡∏•‡∏≠‡∏á - ‡∏ú‡∏±‡∏Å‡∏Å‡∏≤‡∏î‡∏´‡∏≠‡∏°</p>
                        <div class="project-meta">
                            <span class="badge green">‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</span>
                        </div>
                    </div>
                    <div class="project-card" onclick="selectGreenhouse('blue')" id="card-blue">
                        <h3>üîµ Blue Room</h3>
                        <p style="color: #666; margin: 10px 0;">‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ - R&D</p>
                        <div class="project-meta">
                            <span class="badge green">‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Data Display Section -->
            <div id="greenhouseData" style="display: none;">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 id="selectedGreenhouseName" style="margin: 0;">üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• - ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏ô No.1</h3>
                        <button class="btn btn-secondary" onclick="clearSelection()">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏ô</button>
                    </div>
                </div>

                <!-- Real-time Stats -->
                <div class="sensor-stats">
                <div class="stat-card">
                    <div class="stat-label">pH</div>
                    <div class="stat-value">6.2</div>
                    <div class="stat-label">‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: 5 ‡∏ô‡∏≤‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">EC (mS/cm)</div>
                    <div class="stat-value">2.1</div>
                    <div class="stat-label">‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: 5 ‡∏ô‡∏≤‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ (¬∞C)</div>
                    <div class="stat-value">26.5</div>
                    <div class="stat-label">‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: 5 ‡∏ô‡∏≤‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">PPFD (¬µmol/m¬≤/s)</div>
                    <div class="stat-value">250</div>
                    <div class="stat-label">‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: 5 ‡∏ô‡∏≤‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß</div>
                </div>
            </div>

                <!-- Charts -->
                <div class="chart-grid">
                    <div class="chart-container">
                        <h3>üìà pH - 7 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤</h3>
                        <canvas id="phChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>üìà EC - 7 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤</h3>
                        <canvas id="ecChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>üìà ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ - 7 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤</h3>
                        <canvas id="tempChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>üìà PPFD - 7 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤</h3>
                        <canvas id="ppfdChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script>
        // Templates data
        const templates = {
            lettuce: {
                name: '‡∏ú‡∏±‡∏Å‡∏Å‡∏≤‡∏î‡∏´‡∏≠‡∏°',
                fields: ['‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏ï‡πâ‡∏ô (cm)', '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡πÉ‡∏ö (cm)', '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÉ‡∏ö (cm)', '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÉ‡∏ö', '‡∏ó‡∏£‡∏á‡∏û‡∏∏‡πà‡∏° (cm)', '‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏£‡∏≤‡∏Å (g)', '‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥']
            },
            leafy: {
                name: '‡∏ú‡∏±‡∏Å‡πÉ‡∏ö',
                fields: ['‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á (cm)', '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÉ‡∏ö', '‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏ö (cm)', '‡∏™‡∏µ‡πÉ‡∏ö', '‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (g)']
            }
        };

        // Projects data
        let projects = [
            {
                id: 1,
                name: '‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏û‡∏∑‡∏ä‡∏ú‡∏±‡∏Å‡πÉ‡∏ö 4 ‡∏ä‡∏ô‡∏¥‡∏î',
                description: '‡∏ú‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å : ‡∏ï‡∏±‡πâ‡∏á‡πÇ‡∏≠‡πã, ‡πÄ‡∏Ñ‡∏•, Sorrel, Frillice',
                startDate: '2025-03-01',
                owner: '‡∏ó‡∏µ‡∏°‡∏ß‡∏¥‡∏à‡∏±‡∏¢ Lab A',
                greenhouse: 'Lab A',
                template: 'leafy',
                rounds: [
                    {
                        id: 1,
                        name: 'Crop 1',
                        plantDate: '2025-03-01',
                        crops: [
                            { id: 1, name: '‡∏ï‡∏±‡πâ‡∏á‡πÇ‡∏≠‡πã', variety: '‡∏ï‡∏±‡πâ‡∏á‡πÇ‡∏≠‡πã 35 ‡∏ß‡∏±‡∏ô', location: 'Layer 1-2', recordCount: 8 },
                            { id: 2, name: '‡πÄ‡∏Ñ‡∏•', variety: '‡πÄ‡∏Ñ‡∏• 47 ‡∏ß‡∏±‡∏ô', location: 'Layer 1-3', recordCount: 7 },
                            { id: 3, name: 'Sorrel', variety: 'Sorrel 38-40 ‡∏ß‡∏±‡∏ô', location: 'Layer 2', recordCount: 6 },
                            { id: 4, name: 'Frillice (‡∏•‡∏î‡πÇ‡∏û‡πÅ‡∏ó‡∏™‡πÄ‡∏ã‡∏µ‡∏¢‡∏°)', variety: 'Frillice 42 ‡∏ß‡∏±‡∏ô', location: 'Layer 3', recordCount: 6 }
                        ]
                    },
                    {
                        id: 2,
                        name: 'Crop 2',
                        plantDate: '2025-06-10',
                        crops: [
                            { id: 1, name: '‡∏ï‡∏±‡πâ‡∏á‡πÇ‡∏≠‡πã', variety: '‡∏ï‡∏±‡πâ‡∏á‡πÇ‡∏≠‡πã 35 ‡∏ß‡∏±‡∏ô', location: 'Layer 1-2', recordCount: 5 },
                            { id: 2, name: '‡πÄ‡∏Ñ‡∏•', variety: '‡πÄ‡∏Ñ‡∏• 47 ‡∏ß‡∏±‡∏ô', location: 'Layer 1-3', recordCount: 6 },
                            { id: 3, name: 'Sorrel', variety: 'Sorrel 40 ‡∏ß‡∏±‡∏ô', location: 'Layer 2', recordCount: 4 },
                            { id: 4, name: 'Frillice (‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå 3)', variety: 'Frillice 42 ‡∏ß‡∏±‡∏ô', location: 'Layer 3', recordCount: 3 }
                        ]
                    },
                    {
                        id: 3,
                        name: 'Crop 3',
                        plantDate: '2025-07-12',
                        crops: [
                            { id: 1, name: '‡∏ï‡∏±‡πâ‡∏á‡πÇ‡∏≠‡πã', variety: '‡∏ï‡∏±‡πâ‡∏á‡πÇ‡∏≠‡πã 35 ‡∏ß‡∏±‡∏ô', location: 'Layer 1-2', recordCount: 0 },
                            { id: 2, name: '‡πÄ‡∏Ñ‡∏•', variety: '‡πÄ‡∏Ñ‡∏• 47 ‡∏ß‡∏±‡∏ô', location: 'Layer 1-3', recordCount: 0 },
                            { id: 3, name: 'Sorrel', variety: 'Sorrel 40 ‡∏ß‡∏±‡∏ô', location: 'Layer 2', recordCount: 0 },
                            { id: 4, name: 'Frillice (‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå 3)', variety: 'Frillice 42 ‡∏ß‡∏±‡∏ô', location: 'Layer 3', recordCount: 0 }
                        ]
                    }
                ]
            }
        ];

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('projectStartDate').valueAsDate = new Date();
            document.getElementById('dataDate').valueAsDate = new Date();
            renderProjects();
            updateDataProjectOptions();
            initSensorCharts();
        });

        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));

            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            if (tabName === 'projects') {
                renderProjects();
            } else if (tabName === 'collect') {
                updateDataProjectOptions();
            }
        }

        function renderProjects() {
            const grid = document.getElementById('projectsGrid');
            grid.innerHTML = projects.map(project => {
                return `
                    <div class="project-card" onclick="viewProject(${project.id})">
                        <h3>${project.name}</h3>
                        <div style="margin-top: 15px; font-size: 0.95em; color: #555; line-height: 1.8;">
                            <div><strong>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≠‡∏ö:</strong> ${project.rounds.length} ‡∏£‡∏≠‡∏ö</div>
                            <div><strong>‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö:</strong> ${project.owner}</div>
                            <div><strong>‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏ô:</strong> ${project.greenhouse || '-'}</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function showProjectsList() {
            document.getElementById('projectsListView').classList.add('active');
            document.getElementById('createProjectView').classList.remove('active');
            document.getElementById('projectDetailView').classList.remove('active');
            renderProjects();
        }

        function showCreateProject() {
            document.getElementById('projectsListView').classList.remove('active');
            document.getElementById('createProjectView').classList.add('active');
            updateTemplatePreview();
        }

        function updateTemplatePreview() {
            const templateSelect = document.getElementById('projectTemplate');
            const templateId = templateSelect.value;
            const preview = document.getElementById('templateFieldsPreview');

            if (templateId === 'custom') {
                preview.innerHTML = '<p style="color: #888;">‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ü‡∏¥‡∏•‡∏î‡πå‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</p>';
            } else {
                const template = templates[templateId];
                preview.innerHTML = template.fields.map(field =>
                    `<div class="field-item">${field}</div>`
                ).join('');
            }
        }

        function createProject(event) {
            event.preventDefault();
            const newProject = {
                id: projects.length + 1,
                name: document.getElementById('projectName').value,
                description: document.getElementById('projectDesc').value,
                startDate: document.getElementById('projectStartDate').value,
                owner: document.getElementById('projectOwner').value,
                greenhouse: document.getElementById('projectGreenhouse').value,
                template: document.getElementById('projectTemplate').value,
                status: 'active',
                rounds: []
            };
            projects.push(newProject);
            alert('‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
            showProjectsList();
            document.getElementById('projectForm').reset();
        }

        // Global variables for navigation
        let currentProjectId = null;
        let currentRoundId = null;
        let currentCropId = null;

        function viewProject(projectId) {
            currentProjectId = projectId;
            const project = projects.find(p => p.id === projectId);
            document.getElementById('projectsListView').classList.remove('active');
            document.getElementById('projectDetailView').classList.add('active');

            const content = document.getElementById('projectDetailContent');
            const totalRecords = project.rounds.reduce((sum, round) =>
                sum + round.crops.reduce((cropSum, crop) => cropSum + crop.recordCount, 0), 0);

            content.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 30px;">
                    <div>
                        <h2>${project.name}</h2>
                        <p style="color: #666; margin-top: 10px;">${project.description}</p>
                        <div style="margin-top: 15px; color: #888;">
                            <div>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°: ${project.startDate}</div>
                            <div>‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö: ${project.owner}</div>
                            <div>Template: ${templates[project.template].name}</div>
                        </div>
                    </div>
                    <button class="btn" onclick="alert('‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≠‡∏ö‡πÉ‡∏´‡∏°‡πà‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡πá‡∏ß ‡πÜ ‡∏ô‡∏µ‡πâ')">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≠‡∏ö‡πÉ‡∏´‡∏°‡πà</button>
                </div>

                <h3 style="margin-bottom: 15px;">‡∏£‡∏≠‡∏ö‡∏õ‡∏•‡∏π‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (${project.rounds.length} ‡∏£‡∏≠‡∏ö, ${totalRecords} ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å)</h3>
                <div class="projects-grid">
                    ${project.rounds.map(round => {
                        return `
                            <div class="project-card" onclick="viewRound(${projectId}, ${round.id})">
                                <div style="width: 100%; height: 180px; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); border-radius: 8px; margin-bottom: 15px;">
                                    <div style="font-size: 80px;">üå±</div>
                                </div>
                                <h3>${round.name}</h3>
                                <p style="color: #666; margin: 10px 0;">
                                    <strong>‡∏û‡∏∑‡∏ä:</strong> ${round.crops.length} ‡∏ä‡∏ô‡∏¥‡∏î (${round.crops.map(c => c.name).join(', ')})<br>
                                    <strong>‡∏ß‡∏±‡∏ô‡∏õ‡∏•‡∏π‡∏Å:</strong> ${round.plantDate}
                                </p>
                                <div class="project-meta">
                                    <span>${round.crops.reduce((sum, crop) => sum + crop.recordCount, 0)} ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</span>
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        function viewRound(projectId, roundId) {
            currentProjectId = projectId;
            currentRoundId = roundId;

            const project = projects.find(p => p.id === projectId);
            const round = project.rounds.find(r => r.id === roundId);

            const content = document.getElementById('projectDetailContent');
            content.innerHTML = `
                <button class="back-btn" onclick="backToProject()">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏î‡∏π‡∏£‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>

                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 30px;">
                    <div>
                        <h2>${project.name} - ${round.name}</h2>
                        <p style="color: #666; margin-top: 10px;">
                            <strong>‡∏û‡∏∑‡∏ä‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å:</strong> ${round.crops.length} ‡∏ä‡∏ô‡∏¥‡∏î |
                            <strong>‡∏ß‡∏±‡∏ô‡∏õ‡∏•‡∏π‡∏Å:</strong> ${round.plantDate} |
                            <strong>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</strong> ${round.crops.reduce((sum, crop) => sum + crop.recordCount, 0)} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
                        </p>
                    </div>
                </div>

                <h3 style="margin-bottom: 15px;">üå± ‡∏û‡∏∑‡∏ä‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (${round.crops.length} ‡∏ä‡∏ô‡∏¥‡∏î)</h3>
                <div class="projects-grid">
                    ${round.crops.map(crop => {
                        // Icon ‡πÅ‡∏•‡∏∞‡∏™‡∏µ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡∏ô‡∏¥‡∏î‡∏û‡∏∑‡∏ä
                        const cropIcons = {
                            '‡∏ï‡∏±‡πâ‡∏á‡πÇ‡∏≠‡πã': { icon: 'ü•¨', bg: 'linear-gradient(135deg, #e8f5e9 0%, #a5d6a7 100%)' },
                            '‡πÄ‡∏Ñ‡∏•': { icon: 'ü•¨', bg: 'linear-gradient(135deg, #e0f2f1 0%, #80cbc4 100%)' },
                            'Sorrel': { icon: 'üåø', bg: 'linear-gradient(135deg, #fff3e0 0%, #ffb74d 100%)' },
                            'Frillice': { icon: 'ü•ó', bg: 'linear-gradient(135deg, #fce4ec 0%, #f48fb1 100%)' },
                            'default': { icon: 'üå±', bg: 'linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%)' }
                        };
                        const cropName = crop.name.includes('‡∏ï‡∏±‡πâ‡∏á‡πÇ‡∏≠‡πã') ? '‡∏ï‡∏±‡πâ‡∏á‡πÇ‡∏≠‡πã' :
                                       crop.name.includes('‡πÄ‡∏Ñ‡∏•') ? '‡πÄ‡∏Ñ‡∏•' :
                                       crop.name.includes('Sorrel') ? 'Sorrel' :
                                       crop.name.includes('Frillice') ? 'Frillice' : 'default';
                        const cropStyle = cropIcons[cropName];

                        return `
                            <div class="project-card" onclick="viewCrop(${projectId}, ${roundId}, ${crop.id})">
                                <div style="width: 100%; height: 180px; display: flex; align-items: center; justify-content: center; background: ${cropStyle.bg}; border-radius: 8px; margin-bottom: 15px;">
                                    <div style="font-size: 80px;">${cropStyle.icon}</div>
                                </div>
                                <h3>${crop.name}</h3>
                                <p style="color: #666; margin: 10px 0; font-size: 0.9rem;">
                                    <strong>‡∏™‡∏≤‡∏¢‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå:</strong> ${crop.variety}<br>
                                    <strong>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á:</strong> ${crop.location}
                                </p>
                                <div class="project-meta">
                                    <span>${crop.recordCount} ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</span>
                                    ${crop.recordCount > 0 ? '<span class="badge green">‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>' : '<span class="badge">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>'}
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        function viewCrop(projectId, roundId, cropId) {
            currentProjectId = projectId;
            currentRoundId = roundId;
            currentCropId = cropId;

            const project = projects.find(p => p.id === projectId);
            const round = project.rounds.find(r => r.id === roundId);
            const crop = round.crops.find(c => c.id === cropId);

            // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å Lab A Crop 3 Excel
            let sampleData = [];

            if (crop.recordCount >= 7) {
                // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏ö‡∏ä‡∏∏‡∏î - ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå Excel (Crop 1)
                if (crop.name === '‡∏ï‡∏±‡πâ‡∏á‡πÇ‡∏≠‡πã') {
                    sampleData = [
                        { date: '2025-03-01', age: 1, stage: '‡πÄ‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏•‡πá‡∏î', height: '-', leafCount: '-', canopy: '-', weight: '-', env: 'Temp 25¬∞C, RH 61%', notes: '‡πÄ‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏•‡πá‡∏î ‡∏õ‡∏¥‡∏î‡∏ù‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏∑‡∏î 3 ‡∏ß‡∏±‡∏ô',
                          images: ['https://images.unsplash.com/photo-1464226184884-fa280b87c399?w=150', 'https://images.unsplash.com/photo-1464226184884-fa280b87c399?w=150'], imageCount: 2 },
                        { date: '2025-03-04', age: 4, stage: '‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏á', height: '-', leafCount: '2‡πÉ‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á', canopy: '-', weight: '-', env: '‡πÅ‡∏™‡∏á 14‡∏ä‡∏°./150ppfd', notes: '‡πÄ‡∏≠‡∏≤‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏á 14 ‡∏ä‡∏°. ‡∏ï‡πâ‡∏ô‡∏á‡∏≠‡∏Å‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå',
                          images: ['https://images.unsplash.com/photo-1464226184884-fa280b87c399?w=150', 'https://images.unsplash.com/photo-1464226184884-fa280b87c399?w=150'], imageCount: 2 },
                        { date: '2025-03-08', age: 8, stage: '‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏•‡∏ô‡πâ‡∏≥‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô Layer 2', height: '-', leafCount: '-', canopy: '-', weight: '-', env: 'EC 1.4, pH 5.8', notes: '‡∏¢‡πâ‡∏≤‡∏¢‡∏•‡∏á‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏• Layer 2',
                          images: ['https://images.unsplash.com/photo-1628773822503-930a7eaecf80?w=150'], imageCount: 1 },
                        { date: '2025-03-15', age: 15, stage: '‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà 1', height: '-', leafCount: '-', canopy: '-', weight: '-', env: 'Temp 20.9¬∞C, RH 75%', notes: '‡∏¢‡πâ‡∏≤‡∏¢‡∏•‡∏á‡∏õ‡∏•‡∏π‡∏Å‡∏à‡∏£‡∏¥‡∏á',
                          images: ['https://images.unsplash.com/photo-1628773822503-930a7eaecf80?w=150', 'https://images.unsplash.com/photo-1628773822503-930a7eaecf80?w=150'], imageCount: 2 },
                        { date: '2025-03-22', age: 22, stage: '‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà 2', height: '3.2-4.4', leafCount: '-', canopy: '5.8-10.3', weight: '-', env: 'EC 2.2, pH 5.7, CO2 723ppm', notes: '‡πÄ‡∏ï‡∏¥‡∏°‡∏ô‡πâ‡∏≥‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πã‡∏¢ 100ml',
                          images: ['https://images.unsplash.com/photo-1622383563227-04401ab4e5ea?w=150', 'https://images.unsplash.com/photo-1622383563227-04401ab4e5ea?w=150', 'https://images.unsplash.com/photo-1622383563227-04401ab4e5ea?w=150'], imageCount: 3 },
                        { date: '2025-03-29', age: 29, stage: '‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà 3', height: '-', leafCount: '-', canopy: '-', weight: '-', env: 'EC 2.2, pH 5.9', notes: '‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á',
                          images: ['https://images.unsplash.com/photo-1622383563227-04401ab4e5ea?w=150'], imageCount: 1 },
                        { date: '2025-04-05', age: 35, stage: '‡πÄ‡∏Å‡πá‡∏ö‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï', height: '-', leafCount: '-', canopy: '-', weight: '120-165', env: 'Final EC 2.1, pH 6.1', notes: '‡πÄ‡∏Å‡πá‡∏ö‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï ‡∏≠‡∏≤‡∏¢‡∏∏ 35 ‡∏ß‡∏±‡∏ô',
                          images: ['https://images.unsplash.com/photo-1622383563227-04401ab4e5ea?w=150', 'https://images.unsplash.com/photo-1622383563227-04401ab4e5ea?w=150', 'https://images.unsplash.com/photo-1622383563227-04401ab4e5ea?w=150'], imageCount: 3 }
                    ];
                } else if (crop.name === '‡πÄ‡∏Ñ‡∏•') {
                    sampleData = [
                        { date: '2025-03-01', age: 1, stage: '‡πÄ‡∏û‡∏≤‡∏∞‡∏õ‡∏¥‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏∑‡∏î', height: '-', leafCount: '-', canopy: '-', weight: '-', env: 'EC 1.1, pH 5.5', notes: '‡πÄ‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏•‡πá‡∏î ‡∏õ‡∏¥‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏∑‡∏î',
                          images: ['https://images.unsplash.com/photo-1464226184884-fa280b87c399?w=150'], imageCount: 1 },
                        { date: '2025-03-04', age: 4, stage: '‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏á', height: '-', leafCount: '2‡πÉ‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á', canopy: '-', weight: '-', env: '‡πÅ‡∏™‡∏á 12‡∏ä‡∏°./150ppfd', notes: '‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏á 12 ‡∏ä‡∏°.',
                          images: ['https://images.unsplash.com/photo-1464226184884-fa280b87c399?w=150', 'https://images.unsplash.com/photo-1464226184884-fa280b87c399?w=150'], imageCount: 2 },
                        { date: '2025-03-08', age: 8, stage: '‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏•‡∏ô‡πâ‡∏≥‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô Layer 1', height: '-', leafCount: '-', canopy: '-', weight: '-', env: 'EC 1.5, pH 6.0', notes: '‡∏¢‡πâ‡∏≤‡∏¢‡∏•‡∏á‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏• Layer 1',
                          images: ['https://images.unsplash.com/photo-1515694346937-94d85e41e6f0?w=150'], imageCount: 1 },
                        { date: '2025-03-21', age: 21, stage: '‡∏Å‡πà‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏õ‡∏•‡∏π‡∏Å', height: '-', leafCount: '-', canopy: '-', weight: '-', env: 'EC 1.8, pH 5.6, Temp 20.8¬∞C', notes: '‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏õ‡∏•‡∏π‡∏Å‡∏ä‡∏±‡πâ‡∏ô‡∏à‡∏£‡∏¥‡∏á',
                          images: ['https://images.unsplash.com/photo-1515694346937-94d85e41e6f0?w=150', 'https://images.unsplash.com/photo-1515694346937-94d85e41e6f0?w=150'], imageCount: 2 },
                        { date: '2025-03-29', age: 29, stage: '‡∏Ç‡∏∂‡πâ‡∏ô‡∏õ‡∏•‡∏π‡∏Å‡∏ö‡∏ô‡∏ä‡∏±‡πâ‡∏ô', height: '-', leafCount: '-', canopy: '-', weight: '-', env: 'EC 1.8, pH 5.8', notes: '‡∏¢‡πâ‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô‡∏õ‡∏•‡∏π‡∏Å‡∏ö‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡∏à‡∏£‡∏¥‡∏á',
                          images: ['https://images.unsplash.com/photo-1515694346937-94d85e41e6f0?w=150', 'https://images.unsplash.com/photo-1515694346937-94d85e41e6f0?w=150'], imageCount: 2 },
                        { date: '2025-04-10', age: 41, stage: '‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà 5', height: '-', leafCount: '-', canopy: '-', weight: '-', env: 'EC 1.9, pH 5.9', notes: '‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á',
                          images: ['https://images.unsplash.com/photo-1515694346937-94d85e41e6f0?w=150'], imageCount: 1 },
                        { date: '2025-04-17', age: 47, stage: '‡πÄ‡∏Å‡πá‡∏ö‡∏ú‡∏•', height: '-', leafCount: '-', canopy: '-', weight: '180-240', env: 'Final EC 1.8, pH 6.0', notes: '‡πÄ‡∏Å‡πá‡∏ö‡∏ú‡∏• ‡∏≠‡∏≤‡∏¢‡∏∏ 47 ‡∏ß‡∏±‡∏ô',
                          images: ['https://images.unsplash.com/photo-1515694346937-94d85e41e6f0?w=150', 'https://images.unsplash.com/photo-1515694346937-94d85e41e6f0?w=150', 'https://images.unsplash.com/photo-1515694346937-94d85e41e6f0?w=150'], imageCount: 3 }
                    ];
                } else if (crop.name === 'Sorrel') {
                    sampleData = [
                        { date: '2025-03-01', age: 1, stage: '‡πÄ‡∏û‡∏≤‡∏∞‡πÅ‡∏ä‡πà‡∏ô‡πâ‡∏≥ 4-5‡∏ä‡∏°.', height: '-', leafCount: '-', leafLength: '-', leafWidth: '-', weight: '-', env: '‡πÉ‡∏™‡πà‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡πÄ‡∏ä‡πá‡∏î‡∏ä‡∏π', notes: '‡πÅ‡∏ä‡πà‡πÄ‡∏°‡∏•‡πá‡∏î 4-5 ‡∏ä‡∏°. ‡πÉ‡∏™‡πà‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏õ‡∏¥‡∏î‡∏ù‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏∑‡∏î 5 ‡∏ß‡∏±‡∏ô',
                          images: ['https://images.unsplash.com/photo-1464226184884-fa280b87c399?w=150'], imageCount: 1 },
                        { date: '2025-03-06', age: 6, stage: '‡∏¢‡πâ‡∏≤‡∏¢‡πÉ‡∏™‡πà‡∏ü‡∏≠‡∏á‡∏ô‡πâ‡∏≥‡∏ó‡∏µ‡πà‡∏°‡∏∑‡∏î 2‡∏ß‡∏±‡∏ô', height: '-', leafCount: '-', leafLength: '-', leafWidth: '-', weight: '-', env: '‡∏ó‡∏µ‡πà‡∏°‡∏∑‡∏î', notes: '‡∏¢‡πâ‡∏≤‡∏¢‡πÉ‡∏™‡πà‡∏ü‡∏≠‡∏á‡∏ô‡πâ‡∏≥ ‡∏£‡∏≠‡πÉ‡∏´‡πâ‡∏á‡∏≠‡∏Å',
                          images: ['https://images.unsplash.com/photo-1464226184884-fa280b87c399?w=150'], imageCount: 1 },
                        { date: '2025-03-09', age: 9, stage: '‡∏¢‡πâ‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏á', height: '-', leafCount: '2‡πÉ‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á', leafLength: '-', leafWidth: '-', weight: '-', env: '‡πÅ‡∏™‡∏á 14‡∏ä‡∏°./150ppfd', notes: '‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏á',
                          images: ['https://images.unsplash.com/photo-1628773822503-930a7eaecf80?w=150'], imageCount: 1 },
                        { date: '2025-03-16', age: 16, stage: '‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏• 2', height: '-', leafCount: '-', leafLength: '-', leafWidth: '-', weight: '-', env: 'EC 1.6, pH 5.8', notes: '‡∏¢‡πâ‡∏≤‡∏¢‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏• 2',
                          images: ['https://images.unsplash.com/photo-1628773822503-930a7eaecf80?w=150', 'https://images.unsplash.com/photo-1628773822503-930a7eaecf80?w=150'], imageCount: 2 },
                        { date: '2025-03-28', age: 28, stage: '‡∏õ‡∏•‡∏π‡∏Å‡∏à‡∏£‡∏¥‡∏á Layer 2', height: '-', leafCount: '-', leafLength: '-', leafWidth: '-', weight: '-', env: 'EC 1.8, pH 6.0', notes: '‡∏¢‡πâ‡∏≤‡∏¢‡∏õ‡∏•‡∏π‡∏Å‡∏à‡∏£‡∏¥‡∏á Layer 2',
                          images: ['https://images.unsplash.com/photo-1628773822503-930a7eaecf80?w=150', 'https://images.unsplash.com/photo-1628773822503-930a7eaecf80?w=150'], imageCount: 2 },
                        { date: '2025-04-08', age: 40, stage: '‡πÄ‡∏Å‡πá‡∏ö‡∏ú‡∏• ‡∏≠‡∏≤‡∏¢‡∏∏ 40‡∏ß‡∏±‡∏ô', height: '-', leafCount: '-', leafLength: '-', leafWidth: '-', weight: '140-180', env: 'Final EC 1.9, pH 6.0', notes: '‡πÄ‡∏Å‡πá‡∏ö‡∏ú‡∏• ‡∏≠‡∏≤‡∏¢‡∏∏ 40 ‡∏ß‡∏±‡∏ô',
                          images: ['https://images.unsplash.com/photo-1628773822503-930a7eaecf80?w=150', 'https://images.unsplash.com/photo-1628773822503-930a7eaecf80?w=150', 'https://images.unsplash.com/photo-1628773822503-930a7eaecf80?w=150'], imageCount: 3 }
                    ];
                } else if (crop.name.includes('Frillice')) {
                    sampleData = [
                        { date: '2025-03-01', age: 1, stage: '‡πÄ‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏•‡πá‡∏î', height: '-', leafCount: '-', canopy: '-', weight: '-', env: '‡∏õ‡∏∏‡πã‡∏¢ Enshi new', notes: '‡πÄ‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏•‡πá‡∏î ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏•‡∏î‡πÇ‡∏û‡πÅ‡∏ó‡∏™‡πÄ‡∏ã‡∏µ‡∏¢‡∏°',
                          images: ['https://images.unsplash.com/photo-1464226184884-fa280b87c399?w=150'], imageCount: 1 },
                        { date: '2025-03-04', age: 4, stage: '‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏á', height: '-', leafCount: '2‡πÉ‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á', canopy: '-', weight: '-', env: '‡πÅ‡∏™‡∏á 14‡∏ä‡∏°./150ppfd', notes: '‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏á',
                          images: ['https://images.unsplash.com/photo-1464226184884-fa280b87c399?w=150', 'https://images.unsplash.com/photo-1464226184884-fa280b87c399?w=150'], imageCount: 2 },
                        { date: '2025-03-08', age: 8, stage: '‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏•‡∏ô‡πâ‡∏≥‡∏ô‡∏¥‡πà‡∏á', height: '-', leafCount: '3‡πÉ‡∏ö‡∏£‡∏ß‡∏°‡πÉ‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á', canopy: '-', weight: '-', env: 'EC 0.8, pH 5.9, CO2 1132ppm', notes: '‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏• ‡πÉ‡∏ä‡πâ‡∏ô‡πâ‡∏≥‡∏ô‡∏¥‡πà‡∏á ‡∏õ‡∏∏‡πã‡∏¢ Enshi new',
                          images: ['https://images.unsplash.com/photo-1622383563227-04401ab4e5ea?w=150'], imageCount: 1 },
                        { date: '2025-03-15', age: 15, stage: '‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà 1', height: '1.2-1.4', leafCount: '3-4‡πÉ‡∏ö‡∏£‡∏ß‡∏°‡πÉ‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á', canopy: '1.8-2.2', weight: '-', env: 'EC 1.3, pH 5.7', notes: '‡∏¢‡πâ‡∏≤‡∏¢‡∏•‡∏á‡∏õ‡∏•‡∏π‡∏Å/‡∏ñ‡∏≤‡∏î 18 ‡∏´‡∏•‡∏∏‡∏°',
                          images: ['https://images.unsplash.com/photo-1622383563227-04401ab4e5ea?w=150', 'https://images.unsplash.com/photo-1622383563227-04401ab4e5ea?w=150'], imageCount: 2 },
                        { date: '2025-03-22', age: 22, stage: '‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà 2', height: '3.3-4.2', leafCount: '5-6‡πÉ‡∏ö‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î', canopy: '6.4-7.6', weight: '-', env: 'EC 0.9, pH 6.3, CO2 723ppm', notes: '‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏õ‡∏∏‡πã‡∏¢‡∏•‡∏î K ‡πÉ‡∏™‡πà‡∏ó‡πà‡∏≠‡∏™‡∏µ‡∏ü‡πâ‡∏≤',
                          images: ['https://images.unsplash.com/photo-1622383563227-04401ab4e5ea?w=150', 'https://images.unsplash.com/photo-1622383563227-04401ab4e5ea?w=150', 'https://images.unsplash.com/photo-1622383563227-04401ab4e5ea?w=150'], imageCount: 3 },
                        { date: '2025-04-12', age: 42, stage: '‡πÄ‡∏Å‡πá‡∏ö‡∏ú‡∏•', height: '-', leafCount: '-', canopy: '-', weight: '135-170', env: 'Final EC 0.9, pH 6.1', notes: '‡πÄ‡∏Å‡πá‡∏ö‡∏ú‡∏• ‡∏≠‡∏≤‡∏¢‡∏∏ 42 ‡∏ß‡∏±‡∏ô ‡∏™‡∏π‡∏ï‡∏£‡∏•‡∏î K ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                          images: ['https://images.unsplash.com/photo-1622383563227-04401ab4e5ea?w=150', 'https://images.unsplash.com/photo-1622383563227-04401ab4e5ea?w=150', 'https://images.unsplash.com/photo-1622383563227-04401ab4e5ea?w=150'], imageCount: 3 }
                    ];
                }
            } else if (crop.recordCount >= 3 && crop.recordCount < 7) {
                // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô - ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏•‡∏π‡∏Å‡∏≠‡∏¢‡∏π‡πà (Crop 2)
                if (crop.name === '‡∏ï‡∏±‡πâ‡∏á‡πÇ‡∏≠‡πã') {
                    sampleData = [
                        { date: '2025-06-10', age: 1, stage: '‡πÄ‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏•‡πá‡∏î', height: '-', leafCount: '-', canopy: '-', weight: '-', env: 'Temp 25¬∞C', notes: '‡πÄ‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏•‡πá‡∏î ‡∏õ‡∏¥‡∏î‡∏ù‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏∑‡∏î',
                          images: ['https://images.unsplash.com/photo-1464226184884-fa280b87c399?w=150'], imageCount: 1 },
                        { date: '2025-06-13', age: 4, stage: '‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏á', height: '-', leafCount: '2‡πÉ‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á', canopy: '-', weight: '-', env: '‡πÅ‡∏™‡∏á 14‡∏ä‡∏°.', notes: '‡πÄ‡∏≠‡∏≤‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏á 14 ‡∏ä‡∏°.',
                          images: ['https://images.unsplash.com/photo-1464226184884-fa280b87c399?w=150'], imageCount: 1 },
                        { date: '2025-06-17', age: 8, stage: '‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏• Layer 3', height: '-', leafCount: '-', canopy: '-', weight: '-', env: 'EC 1.4, pH 5.8', notes: '‡∏¢‡πâ‡∏≤‡∏¢‡∏•‡∏á‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏• Layer 3',
                          images: ['https://images.unsplash.com/photo-1628773822503-930a7eaecf80?w=150'], imageCount: 1 },
                        { date: '2025-06-24', age: 15, stage: '‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà 1', height: '-', leafCount: '-', canopy: '-', weight: '-', env: 'Temp 21¬∞C', notes: '‡∏¢‡πâ‡∏≤‡∏¢‡∏õ‡∏•‡∏π‡∏Å‡∏à‡∏£‡∏¥‡∏á',
                          images: ['https://images.unsplash.com/photo-1628773822503-930a7eaecf80?w=150', 'https://images.unsplash.com/photo-1628773822503-930a7eaecf80?w=150'], imageCount: 2 },
                        { date: '2025-07-01', age: 22, stage: '‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà 2', height: '2.9-3.8', leafCount: '-', canopy: '6.2-8.5', weight: '-', env: 'EC 2.2, pH 5.8', notes: '‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á (‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏•‡∏π‡∏Å)',
                          images: ['https://images.unsplash.com/photo-1622383563227-04401ab4e5ea?w=150', 'https://images.unsplash.com/photo-1622383563227-04401ab4e5ea?w=150'], imageCount: 2 }
                    ];
                } else if (crop.name === '‡πÄ‡∏Ñ‡∏•') {
                    sampleData = [
                        { date: '2025-06-10', age: 1, stage: '‡πÄ‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏•‡πá‡∏î', height: '-', leafCount: '-', canopy: '-', weight: '-', env: 'Temp 25¬∞C', notes: '‡πÄ‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏•‡πá‡∏î ‡∏õ‡∏¥‡∏î‡∏ù‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏∑‡∏î',
                          images: ['https://images.unsplash.com/photo-1464226184884-fa280b87c399?w=150'], imageCount: 1 },
                        { date: '2025-06-13', age: 4, stage: '‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏á', height: '-', leafCount: '2‡πÉ‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á', canopy: '-', weight: '-', env: '‡πÅ‡∏™‡∏á 12‡∏ä‡∏°./150ppfd', notes: '‡πÄ‡∏≠‡∏≤‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏á 12 ‡∏ä‡∏°.',
                          images: ['https://images.unsplash.com/photo-1464226184884-fa280b87c399?w=150', 'https://images.unsplash.com/photo-1464226184884-fa280b87c399?w=150'], imageCount: 2 },
                        { date: '2025-06-17', age: 8, stage: '‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏• Layer 3', height: '-', leafCount: '3-4‡πÉ‡∏ö‡∏£‡∏ß‡∏°‡πÉ‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á', canopy: '-', weight: '-', env: 'EC 1.4, pH 6.0', notes: '‡∏¢‡πâ‡∏≤‡∏¢‡∏•‡∏á‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏• Layer 3',
                          images: ['https://images.unsplash.com/photo-1515694346937-94d85e41e6f0?w=150', 'https://images.unsplash.com/photo-1515694346937-94d85e41e6f0?w=150'], imageCount: 2 },
                        { date: '2025-06-24', age: 15, stage: '‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà 1', height: '-', leafCount: '-', canopy: '-', weight: '-', env: 'Temp 20¬∞C', notes: '‡∏¢‡πâ‡∏≤‡∏¢‡∏õ‡∏•‡∏π‡∏Å‡∏à‡∏£‡∏¥‡∏á',
                          images: ['https://images.unsplash.com/photo-1515694346937-94d85e41e6f0?w=150'], imageCount: 1 },
                        { date: '2025-07-01', age: 22, stage: '‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà 2', height: '9.8-12.5', leafCount: '-', canopy: '8.5-11.2', weight: '-', env: 'EC 1.8, pH 6.2', notes: '‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á (‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏•‡∏π‡∏Å)',
                          images: ['https://images.unsplash.com/photo-1515694346937-94d85e41e6f0?w=150', 'https://images.unsplash.com/photo-1515694346937-94d85e41e6f0?w=150'], imageCount: 2 }
                    ];
                } else if (crop.name === 'Sorrel') {
                    sampleData = [
                        { date: '2025-06-10', age: 1, stage: '‡πÄ‡∏û‡∏≤‡∏∞‡πÅ‡∏ä‡πà‡∏ô‡πâ‡∏≥', height: '-', leafCount: '-', leafLength: '-', leafWidth: '-', weight: '-', env: '‡πÅ‡∏ä‡πà‡∏ô‡πâ‡∏≥ 4-5 ‡∏ä‡∏°.', notes: '‡πÅ‡∏ä‡πà‡∏ô‡πâ‡∏≥ ‡∏õ‡∏¥‡∏î‡∏ù‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏∑‡∏î',
                          images: ['https://images.unsplash.com/photo-1464226184884-fa280b87c399?w=150'], imageCount: 1 },
                        { date: '2025-06-15', age: 6, stage: '‡∏õ‡∏¥‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏∑‡∏î', height: '-', leafCount: '-', leafLength: '-', leafWidth: '-', weight: '-', env: '‡∏õ‡∏¥‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏∑‡∏î 5 ‡∏ß‡∏±‡∏ô', notes: '‡∏õ‡∏¥‡∏î‡∏ù‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏∑‡∏î (‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏á‡∏≠‡∏Å)',
                          images: ['https://images.unsplash.com/photo-1464226184884-fa280b87c399?w=150'], imageCount: 1 },
                        { date: '2025-06-16', age: 7, stage: '‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏á', height: '-', leafCount: '2‡πÉ‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á', leafLength: '-', leafWidth: '-', weight: '-', env: '‡πÅ‡∏™‡∏á 14‡∏ä‡∏°.', notes: '‡πÄ‡∏≠‡∏≤‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏á 14 ‡∏ä‡∏°.',
                          images: ['https://images.unsplash.com/photo-1628773822503-930a7eaecf80?w=150'], imageCount: 1 },
                        { date: '2025-06-23', age: 14, stage: '‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏•', height: '-', leafCount: '4-5‡πÉ‡∏ö‡∏£‡∏ß‡∏°‡πÉ‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á', leafLength: '2.8-3.5', leafWidth: '1.5-2.2', weight: '-', env: 'EC 1.6, pH 5.8', notes: '‡∏¢‡πâ‡∏≤‡∏¢‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏•',
                          images: ['https://images.unsplash.com/photo-1628773822503-930a7eaecf80?w=150', 'https://images.unsplash.com/photo-1628773822503-930a7eaecf80?w=150'], imageCount: 2 },
                        { date: '2025-07-01', age: 22, stage: '‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà 2', height: '-', leafCount: '-', leafLength: '6.5-8.2', leafWidth: '4.2-5.5', weight: '-', env: 'EC 1.9, pH 6.0', notes: '‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á (‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏•‡∏π‡∏Å)',
                          images: ['https://images.unsplash.com/photo-1628773822503-930a7eaecf80?w=150', 'https://images.unsplash.com/photo-1628773822503-930a7eaecf80?w=150'], imageCount: 2 }
                    ];
                } else if (crop.name.includes('Frillice')) {
                    sampleData = [
                        { date: '2025-06-10', age: 1, stage: '‡πÄ‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏•‡πá‡∏î', height: '-', leafCount: '-', canopy: '-', weight: '-', env: '‡∏õ‡∏∏‡πã‡∏¢ Enshi new', notes: '‡πÄ‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏•‡πá‡∏î ‡∏õ‡∏¥‡∏î‡∏ù‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏∑‡∏î',
                          images: ['https://images.unsplash.com/photo-1464226184884-fa280b87c399?w=150'], imageCount: 1 },
                        { date: '2025-06-13', age: 4, stage: '‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏á', height: '-', leafCount: '2‡πÉ‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á', canopy: '-', weight: '-', env: '‡πÅ‡∏™‡∏á 14‡∏ä‡∏°.', notes: '‡πÄ‡∏≠‡∏≤‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏á 14 ‡∏ä‡∏°.',
                          images: ['https://images.unsplash.com/photo-1464226184884-fa280b87c399?w=150'], imageCount: 1 },
                        { date: '2025-06-19', age: 10, stage: '‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏•‡∏ô‡πâ‡∏≥‡∏ô‡∏¥‡πà‡∏á', height: '-', leafCount: '3-4‡πÉ‡∏ö‡∏£‡∏ß‡∏°‡πÉ‡∏ö‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á', canopy: '-', weight: '-', env: 'EC 0.8, pH 5.5', notes: '‡∏¢‡πâ‡∏≤‡∏¢‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏• ‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢‡∏ó‡πà‡∏≠‡∏™‡∏µ‡∏ü‡πâ‡∏≤',
                          images: ['https://images.unsplash.com/photo-1622383563227-04401ab4e5ea?w=150', 'https://images.unsplash.com/photo-1622383563227-04401ab4e5ea?w=150'], imageCount: 2 },
                        { date: '2025-06-26', age: 17, stage: '‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà 1', height: '-', leafCount: '-', canopy: '-', weight: '-', env: 'Temp 22¬∞C', notes: '‡∏¢‡πâ‡∏≤‡∏¢‡∏õ‡∏•‡∏π‡∏Å‡∏à‡∏£‡∏¥‡∏á',
                          images: ['https://images.unsplash.com/photo-1622383563227-04401ab4e5ea?w=150'], imageCount: 1 },
                        { date: '2025-07-03', age: 24, stage: '‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ó‡∏µ‡πà 2', height: '8.5-11.2', leafCount: '-', canopy: '7.2-9.8', weight: '-', env: 'EC 1.3, pH 5.8', notes: '‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏õ‡∏∏‡πã‡∏¢‡∏•‡∏î K (‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏•‡∏π‡∏Å)',
                          images: ['https://images.unsplash.com/photo-1622383563227-04401ab4e5ea?w=150', 'https://images.unsplash.com/photo-1622383563227-04401ab4e5ea?w=150'], imageCount: 2 }
                    ];
                }
            }

            const content = document.getElementById('projectDetailContent');
            content.innerHTML = `
                <button class="back-btn" onclick="backToRound()">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏î‡∏π‡∏û‡∏∑‡∏ä‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>

                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 30px;">
                    <div>
                        <h2>${project.name} - ${round.name} - ${crop.name}</h2>
                        <p style="color: #666; margin-top: 10px;">
                            <strong>‡∏™‡∏≤‡∏¢‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå:</strong> ${crop.variety} |
                            <strong>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á:</strong> ${crop.location} |
                            <strong>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å:</strong> ${crop.recordCount} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
                        </p>
                    </div>
                    <button class="btn" onclick="alert('‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡πá‡∏ß ‡πÜ ‡∏ô‡∏µ‡πâ')">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏´‡∏°‡πà</button>
                </div>

                <div class="card">
                    <h3 style="margin-bottom: 15px;">üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï</h3>
                    ${sampleData.length > 0 ? `
                        <div style="overflow-x: auto;">
                            <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
                                <thead>
                                    <tr style="background: #f8f9fa;">
                                        <th style="padding: 10px; text-align: left; border: 1px solid #e0e0e0;">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                        <th style="padding: 10px; text-align: center; border: 1px solid #e0e0e0;">‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏ß‡∏±‡∏ô)</th>
                                        <th style="padding: 10px; text-align: left; border: 1px solid #e0e0e0;">‡∏£‡∏∞‡∏¢‡∏∞</th>
                                        <th style="padding: 10px; text-align: center; border: 1px solid #e0e0e0;">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á (cm)</th>
                                        <th style="padding: 10px; text-align: center; border: 1px solid #e0e0e0;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÉ‡∏ö</th>
                                        ${crop.name === 'Sorrel' ?
                                            '<th style="padding: 10px; text-align: center; border: 1px solid #e0e0e0;">‡∏¢‡∏≤‡∏ß‡πÉ‡∏ö (cm)</th><th style="padding: 10px; text-align: center; border: 1px solid #e0e0e0;">‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÉ‡∏ö (cm)</th>' :
                                            '<th style="padding: 10px; text-align: center; border: 1px solid #e0e0e0;">‡∏ó‡∏£‡∏á‡∏û‡∏∏‡πà‡∏° (cm)</th>'
                                        }
                                        <th style="padding: 10px; text-align: center; border: 1px solid #e0e0e0;">‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (g)</th>
                                        <th style="padding: 10px; text-align: center; border: 1px solid #e0e0e0;">‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°</th>
                                        <th style="padding: 10px; text-align: center; border: 1px solid #e0e0e0;">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</th>
                                        <th style="padding: 10px; text-align: left; border: 1px solid #e0e0e0;">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${sampleData.map((data, index) => `
                                        <tr>
                                            <td style="padding: 10px; border: 1px solid #e0e0e0;">${data.date}</td>
                                            <td style="padding: 10px; text-align: center; border: 1px solid #e0e0e0;">${data.age}</td>
                                            <td style="padding: 10px; border: 1px solid #e0e0e0;">${data.stage}</td>
                                            <td style="padding: 10px; text-align: center; border: 1px solid #e0e0e0;">${data.height}</td>
                                            <td style="padding: 10px; text-align: center; border: 1px solid #e0e0e0;">${data.leafCount}</td>
                                            ${crop.name === 'Sorrel' ?
                                                `<td style="padding: 10px; text-align: center; border: 1px solid #e0e0e0;">${data.leafLength}</td><td style="padding: 10px; text-align: center; border: 1px solid #e0e0e0;">${data.leafWidth}</td>` :
                                                `<td style="padding: 10px; text-align: center; border: 1px solid #e0e0e0;">${data.canopy}</td>`
                                            }
                                            <td style="padding: 10px; text-align: center; border: 1px solid #e0e0e0;">${data.weight}</td>
                                            <td style="padding: 10px; text-align: center; border: 1px solid #e0e0e0; font-size: 0.8rem;">${data.env}</td>
                                            <td style="padding: 10px; text-align: center; border: 1px solid #e0e0e0;">
                                                <button onclick="showImages(${index})"
                                                        style="background: #43cea2; color: white; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 0.85rem;">
                                                    üì∑ ‡∏î‡∏π‡∏£‡∏π‡∏õ (${data.imageCount})
                                                </button>
                                            </td>
                                            <td style="padding: 10px; border: 1px solid #e0e0e0; font-size: 0.85rem;">${data.notes}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    ` : '<p style="color: #888; padding: 20px; text-align: center;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• - ‡∏£‡∏≠‡∏ö‡∏ô‡∏µ‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô</p>'}
                </div>

                <!-- Image Modal -->
                <div id="imageModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 9999; padding: 20px; overflow-y: auto;">
                    <div style="max-width: 900px; margin: 40px auto; position: relative;">
                        <button onclick="closeImageModal()"
                                style="position: absolute; top: -40px; right: 0; background: white; color: #333; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-size: 1rem; font-weight: 600;">
                            ‚úï ‡∏õ‡∏¥‡∏î
                        </button>
                        <div id="imageModalContent" style="background: white; padding: 30px; border-radius: 15px;">
                        </div>
                    </div>
                </div>

                <script>
                    const recordImages_${projectId}_${roundId}_${cropId} = ${JSON.stringify(sampleData.map(d => d.images))};
                    const recordData_${projectId}_${roundId}_${cropId} = ${JSON.stringify(sampleData.map(d => ({ date: d.date })))};

                    window.showImages = function(recordIndex) {
                        const modal = document.getElementById('imageModal');
                        const content = document.getElementById('imageModalContent');
                        const images = recordImages_${projectId}_${roundId}_${cropId}[recordIndex];
                        const recordDate = recordData_${projectId}_${roundId}_${cropId}[recordIndex].date;

                        let imageHTML = '<h3 style="margin-bottom: 20px; color: #333;">üì∑ ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ' + recordDate + '</h3>';
                        imageHTML += '<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px;">';

                        images.forEach(function(img) {
                            imageHTML += '<div style="border-radius: 8px; overflow: hidden; border: 2px solid #e0e0e0;">';
                            imageHTML += '<img src="' + img + '" style="width: 100%; height: 200px; object-fit: cover; cursor: pointer;" onclick="window.open(\'' + img + '\', \'_blank\')">';
                            imageHTML += '</div>';
                        });

                        imageHTML += '</div>';
                        imageHTML += '<p style="margin-top: 15px; color: #666; font-size: 0.9rem;">üí° ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏ï‡πá‡∏°</p>';

                        content.innerHTML = imageHTML;
                        modal.style.display = 'block';
                        document.body.style.overflow = 'hidden';
                    };

                    window.closeImageModal = function() {
                        document.getElementById('imageModal').style.display = 'none';
                        document.body.style.overflow = 'auto';
                    };

                    // Close modal when clicking outside
                    document.getElementById('imageModal')?.addEventListener('click', function(e) {
                        if (e.target === this) {
                            closeImageModal();
                        }
                    });
                <\/script>
            `;
        }

        function backToProject() {
            if (currentProjectId) {
                viewProject(currentProjectId);
            }
        }

        function backToRound() {
            if (currentProjectId && currentRoundId) {
                viewRound(currentProjectId, currentRoundId);
            }
        }

        function updateDataProjectOptions() {
            const select = document.getElementById('dataProject');
            select.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</option>' +
                projects.map(p => `<option value="${p.id}">${p.name}</option>`).join('');
        }

        function updateDataRounds() {
            const projectId = parseInt(document.getElementById('dataProject').value);
            const select = document.getElementById('dataRound');

            if (!projectId) {
                select.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≠‡∏ö</option>';
                return;
            }

            const project = projects.find(p => p.id === projectId);
            select.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≠‡∏ö</option>' +
                project.rounds.map(r => `<option value="${r.id}">${r.name} - ${r.plants.join(', ')}</option>`).join('');
        }

        function previewDataImages(event) {
            const preview = document.getElementById('dataImagePreview');
            preview.innerHTML = '';

            const files = event.target.files;
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const reader = new FileReader();

                reader.onload = function(e) {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    preview.appendChild(img);
                }

                reader.readAsDataURL(file);
            }
        }

        document.getElementById('dataForm').addEventListener('submit', function(e) {
            e.preventDefault();
            alert('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\n\n‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤ AI');
            this.reset();
            document.getElementById('dataImagePreview').innerHTML = '';
        });

        // Settings dropdown functions
        function toggleSettings() {
            const menu = document.getElementById('settingsMenu');
            menu.classList.toggle('show');
        }

        function showTemplates() {
            alert('üìù Templates Management\n\n‡πÅ‡∏™‡∏î‡∏á:\n- Template: ‡∏ú‡∏±‡∏Å‡∏Å‡∏≤‡∏î‡∏´‡∏≠‡∏° (‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô 3 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á)\n- Template: ‡∏ú‡∏±‡∏Å‡πÉ‡∏ö (‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô 8 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á)\n- + ‡∏™‡∏£‡πâ‡∏≤‡∏á Template ‡πÉ‡∏´‡∏°‡πà\n\n‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Templates ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö');
            document.getElementById('settingsMenu').classList.remove('show');
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const dropdown = document.querySelector('.settings-dropdown');
            const menu = document.getElementById('settingsMenu');

            if (!dropdown.contains(event.target)) {
                menu.classList.remove('show');
            }
        });

        // Sensor Charts
        function initSensorCharts() {
            const days = ['6 ‡∏ß‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô', '5 ‡∏ß‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô', '4 ‡∏ß‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô', '3 ‡∏ß‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô', '2 ‡∏ß‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô', '‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ß‡∏≤‡∏ô', '‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ'];

            // pH Chart
            new Chart(document.getElementById('phChart'), {
                type: 'line',
                data: {
                    labels: days,
                    datasets: [{
                        label: 'pH',
                        data: [6.1, 6.0, 6.2, 6.3, 6.1, 6.2, 6.2],
                        borderColor: '#43cea2',
                        backgroundColor: 'rgba(67, 206, 162, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { display: false } }
                }
            });

            // EC Chart
            new Chart(document.getElementById('ecChart'), {
                type: 'line',
                data: {
                    labels: days,
                    datasets: [{
                        label: 'EC (mS/cm)',
                        data: [2.0, 2.1, 2.2, 2.1, 2.0, 2.1, 2.1],
                        borderColor: '#185a9d',
                        backgroundColor: 'rgba(24, 90, 157, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { display: false } }
                }
            });

            // Temperature Chart
            new Chart(document.getElementById('tempChart'), {
                type: 'line',
                data: {
                    labels: days,
                    datasets: [{
                        label: '‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ (¬∞C)',
                        data: [25.5, 26.0, 26.5, 27.0, 26.5, 26.0, 26.5],
                        borderColor: '#ff6b6b',
                        backgroundColor: 'rgba(255, 107, 107, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { display: false } }
                }
            });

            // PPFD Chart
            new Chart(document.getElementById('ppfdChart'), {
                type: 'line',
                data: {
                    labels: days,
                    datasets: [{
                        label: 'PPFD (¬µmol/m¬≤/s)',
                        data: [245, 250, 248, 252, 250, 248, 250],
                        borderColor: '#ffd93d',
                        backgroundColor: 'rgba(255, 217, 61, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { display: false } }
                }
            });
        }

        // Greenhouse Selection Functions
        let selectedGreenhouse = null;

        const greenhouseData = {
            no1: {
                name: 'üè† No.1 - ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏Å',
                sensors: {
                    ph: 6.2,
                    ec: 2.1,
                    temp: 26.5,
                    ppfd: 250
                },
                history: {
                    ph: [6.1, 6.0, 6.2, 6.3, 6.1, 6.2, 6.2],
                    ec: [2.0, 2.1, 2.2, 2.1, 2.0, 2.1, 2.1],
                    temp: [25.5, 26.0, 26.5, 27.0, 26.5, 26.0, 26.5],
                    ppfd: [245, 250, 248, 252, 250, 248, 250]
                }
            },
            laba: {
                name: 'üî¨ Lab A - Lab ‡∏ó‡∏î‡∏•‡∏≠‡∏á',
                sensors: {
                    ph: 6.5,
                    ec: 1.8,
                    temp: 24.2,
                    ppfd: 280
                },
                history: {
                    ph: [6.4, 6.5, 6.6, 6.5, 6.4, 6.5, 6.5],
                    ec: [1.7, 1.8, 1.9, 1.8, 1.7, 1.8, 1.8],
                    temp: [23.8, 24.0, 24.2, 24.5, 24.3, 24.1, 24.2],
                    ppfd: [275, 280, 278, 282, 280, 278, 280]
                }
            },
            blue: {
                name: 'üîµ Blue Room - ‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥',
                sensors: {
                    ph: 5.8,
                    ec: 2.3,
                    temp: 22.0,
                    ppfd: 320
                },
                history: {
                    ph: [5.7, 5.8, 5.9, 5.8, 5.7, 5.8, 5.8],
                    ec: [2.2, 2.3, 2.4, 2.3, 2.2, 2.3, 2.3],
                    temp: [21.5, 22.0, 22.2, 22.5, 22.3, 22.1, 22.0],
                    ppfd: [315, 320, 318, 322, 320, 318, 320]
                }
            }
        };

        function selectGreenhouse(id) {
            selectedGreenhouse = id;
            const data = greenhouseData[id];

            // Hide selection cards
            document.getElementById('greenhouseCards').parentElement.style.display = 'none';

            // Show data section
            document.getElementById('greenhouseData').style.display = 'block';

            // Update title
            document.getElementById('selectedGreenhouseName').textContent = `üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• - ${data.name}`;

            // Update real-time stats
            document.querySelectorAll('.stat-value')[0].textContent = data.sensors.ph;
            document.querySelectorAll('.stat-value')[1].textContent = data.sensors.ec;
            document.querySelectorAll('.stat-value')[2].textContent = data.sensors.temp;
            document.querySelectorAll('.stat-value')[3].textContent = data.sensors.ppfd;

            // Update charts
            updateCharts(data.history);
        }

        function clearSelection() {
            selectedGreenhouse = null;

            // Show selection cards
            document.getElementById('greenhouseCards').parentElement.style.display = 'block';

            // Hide data section
            document.getElementById('greenhouseData').style.display = 'none';
        }

        function updateCharts(history) {
            const days = ['6 ‡∏ß‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô', '5 ‡∏ß‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô', '4 ‡∏ß‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô', '3 ‡∏ß‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô', '2 ‡∏ß‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô', '‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ß‡∏≤‡∏ô', '‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ'];

            // Destroy existing charts
            Chart.getChart('phChart')?.destroy();
            Chart.getChart('ecChart')?.destroy();
            Chart.getChart('tempChart')?.destroy();
            Chart.getChart('ppfdChart')?.destroy();

            // pH Chart
            new Chart(document.getElementById('phChart'), {
                type: 'line',
                data: {
                    labels: days,
                    datasets: [{
                        label: 'pH',
                        data: history.ph,
                        borderColor: '#43cea2',
                        backgroundColor: 'rgba(67, 206, 162, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { display: false } }
                }
            });

            // EC Chart
            new Chart(document.getElementById('ecChart'), {
                type: 'line',
                data: {
                    labels: days,
                    datasets: [{
                        label: 'EC (mS/cm)',
                        data: history.ec,
                        borderColor: '#185a9d',
                        backgroundColor: 'rgba(24, 90, 157, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { display: false } }
                }
            });

            // Temperature Chart
            new Chart(document.getElementById('tempChart'), {
                type: 'line',
                data: {
                    labels: days,
                    datasets: [{
                        label: '‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ (¬∞C)',
                        data: history.temp,
                        borderColor: '#ff6b6b',
                        backgroundColor: 'rgba(255, 107, 107, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { display: false } }
                }
            });

            // PPFD Chart
            new Chart(document.getElementById('ppfdChart'), {
                type: 'line',
                data: {
                    labels: days,
                    datasets: [{
                        label: 'PPFD (¬µmol/m¬≤/s)',
                        data: history.ppfd,
                        borderColor: '#ffd93d',
                        backgroundColor: 'rgba(255, 217, 61, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { display: false } }
                }
            });
        }
    </script>
</body>
</html>
