# Production Dashboard Prototype

**Idea 1: Energy Cost Tracking per Vegetable Type**

## Overview

Dashboard สำหรับติดตามต้นทุนพลังงานต่อผลผลิตแต่ละชนิดผักในระบบ PFAL (Plant Factory with Artificial Lighting) เพื่อวิเคราะห์ประสิทธิภาพการใช้ไฟฟ้า

## Objectives

- ติดตามต้นทุนพลังงาน (kWh, ฿) ต่อผลผลิตแต่ละชนิดผัก
- วิเคราะห์ประสิทธิภาพการใช้ไฟฟ้า (kWh/kg)
- เปรียบเทียบต้นทุนพลังงานระหว่างผักชนิดต่างๆ
- สนับสนุนการตัดสินใจเลือกปลูกผักที่ประหยัดพลังงาน

## Data Sources

### 1. Automatic (from IoT System)
- **การใช้ไฟฟ้ารวม (kWh)**: จาก Controller Gen3 + Modbus energy meter
- **วันเวลาที่ใช้ไฟ**: ข้อมูล timestamp จาก sensor
- **โซนการปลูก**: 16 light zones ตาม Controller Gen3

### 2. Manual Input (User Entry)
- **วันที่เก็บเกี่ยว**: วันที่ harvest
- **โรงเรือน**: โรงปลูกที่ 1, 2, 3
- **ข้อมูลถาด**:
  - ประเภทถาด: Hydroponic Tray 112×65 cm / 2m NFT/DFT / Ebb & Flow 2m
  - จำนวนถาด: จำนวนถาดรวมที่เก็บเกี่ยว
  - การใช้หลุม: checkbox "ปลูกเต็มหลุม" (default: checked)
  - จำนวนหลุมที่ใช้: ระบุจำนวนหลุมที่ปลูกจริง (ถ้าไม่เต็มหลุม)
- **ชนิดผัก**: ผักกาดหอม, คะน้า, ผักโขม, โหระพา
- **น้ำหนักที่เก็บได้ (kg)**: ผลผลิตรวม
- **วันที่เริ่มปลูก**: วันที่ transplant

## Calculation Method

### Area-Time Based Allocation

```
พลังงานต่อผัก = (พื้นที่ × จำนวนวันปลูก / พื้นที่-วันรวม) × พลังงานรวม

ตัวอย่าง:
- พื้นที่: 5.32 ตร.ม.
- จำนวนวันปลูก: 30 วัน
- อัตราพลังงาน: 2.8 kWh/ตร.ม./วัน (mock data)
- พลังงานรวม = 5.32 × 30 × 2.8 = 446.88 kWh
```

### Energy Efficiency Metrics

```
1. ประสิทธิภาพพลังงาน (kWh/kg)
   = พลังงานรวม / น้ำหนักผลผลิต
   = 446.88 kWh / 25 kg
   = 17.88 kWh/kg
   (ใช้ไฟ 17.88 หน่วย เพื่อผลิตผัก 1 kg)

2. ผลผลิตต่อหน่วยพลังงาน (kg/kWh)
   = น้ำหนักผลผลิต / พลังงานรวม
   = 25 kg / 446.88 kWh
   = 0.056 kg/kWh
   (ใช้ไฟ 1 หน่วย ได้ผัก 0.056 kg)
```

## Features

### 1. Dashboard Display
- **การใช้พลังงานรวม**: แสดง kWh และค่าใช้จ่าย (฿)
- **ประสิทธิภาพพลังงาน**: แสดง kWh/kg เฉลี่ย
- **กราฟสัดส่วน**: แสดงการกระจายพลังงานและผลผลิตตามชนิดผัก
- **ตารางรายละเอียด**: แสดงข้อมูลแต่ละชนิดผัก
  - ผลผลิต (kg)
  - พลังงาน (kWh)
  - พลังงาน (kWh/kg)
  - ค่าไฟ (฿/kg)

### 2. Input Form with Real-time Calculation
- **Simplified tray input**: กรอกจำนวนถาดรวมที่เก็บเกี่ยวโดยตรง
- **Checkbox pattern**: checkbox "ปลูกเต็มหลุม" (default checked) - uncheck เพื่อระบุจำนวนหลุมที่ใช้
- **Auto-calculation**: คำนวณพื้นที่, จำนวนหลุม, พื้นที่จริงอัตโนมัติ
- **Proportional area**: คำนวณพื้นที่จริงตามสัดส่วนหลุมที่ใช้ (ถ้าไม่เต็มหลุม)
- **Energy preview**: แสดงประมาณการพลังงานขณะกรอกข้อมูล
  - จำนวนวันปลูก
  - ใช้ไฟรวม (kWh)
  - ประสิทธิภาพ (kWh/kg)
  - ผลผลิตต่อหน่วย (kg/kWh)

### 3. Filter & Analysis
- **ช่วงเวลา**: เลือกปี + เดือน
- **ชนิดผัก**: กรองตามประเภทผัก
- **เปรียบเทียบ**: วิเคราะห์ต้นทุนพลังงานระหว่างผักต่างชนิด

## Tray Specifications

จากสินค้าจริงของ Civic AgroTech:

| ประเภทถาด | ขนาด (ก×ย×ส cm) | พื้นที่ (ตร.ม.) | จำนวนหลุม | ราคา (฿) |
|-----------|----------------|----------------|-----------|----------|
| Hydroponic Tray | 112×65 | 0.73 | 24 | 1,500 |
| Hydroponic Tray 2m NFT/DFT | 113×235×8 | 2.66 | 100 | 2,800 |
| Ebb & Flow Tray 2m | 113×230×11 | 2.60 | 100 | 2,800 |

## Technology Stack

- **Frontend**: HTML5, CSS3, Vanilla JavaScript
- **Charts**: Chart.js (doughnut charts for data visualization)
- **IoT Integration**: Controller Gen3 with Modbus energy meter
- **Data Format**: JSON mock data (ready for API integration)

## Strengths

- ✅ ใช้ข้อมูลจริงจาก IoT meter (automatic energy data)
- ✅ คำนวณแบบ Area-Time Based Allocation (fair distribution)
- ✅ แสดงผล real-time ตอนกรอกข้อมูล
- ✅ UX ที่เรียบง่าย ชัดเจน (กรอกจำนวนถาดโดยตรง)
- ✅ รองรับการใช้ถาดไม่เต็มหลุม (proportional area calculation)
- ✅ ใช้ข้อมูลสินค้าจริงจาก Civic AgroTech

## Limitations

- ⚠️ **ผลผลิตต้อง manual input**: ต้องชั่งน้ำหนักและใส่เองหลังเก็บเกี่ยว
- ⚠️ **ยังไม่รวมต้นทุนอื่น**: ไม่มีค่าแรงงาน, ปุ๋ย, น้ำ (focus เฉพาะพลังงาน)
- ⚠️ **Mock energy rate**: ใช้ค่า 2.8 kWh/ตร.ม./วัน เป็นค่าสมมติ (จริงต้องดึงจาก meter)

## Alignment with Probation Project

**IoT + PFAL Project (Month 1 - Ideas v2)**

Dashboard นี้สอดคล้องกับโครงการ probation เพราะ:
- ใช้ IoT sensors (Controller Gen3 + Modbus meter) สำหรับ automatic data collection
- ประยุกต์ใช้กับ PFAL system ของ Civic AgroTech
- วิเคราะห์ข้อมูลเพื่อเพิ่มประสิทธิภาพการผลิต

## Future Enhancements

1. **Real energy data integration**: เชื่อมต่อ API ดึงข้อมูลจาก meter จริง
2. **Zone-based allocation**: คำนวณตามโซนไฟที่ใช้จริง (16 zones)
3. **Historical comparison**: เปรียบเทียบประสิทธิภาพระหว่างรอบการปลูก
4. **Comprehensive cost tracking**: เพิ่มต้นทุนด้านอื่นๆ (แรงงาน, ปุ๋ย, น้ำ)
5. **Mobile responsive**: ปรับ UI ให้ใช้งานบนมือถือได้สะดวก
6. **Export reports**: ส่งออกรายงาน PDF/Excel

## Files

- `idea1-production-dashboard.html` - Main prototype file (standalone HTML/CSS/JS)
- `README.md` - This documentation

## Usage

1. เปิดไฟล์ `idea1-production-dashboard.html` ในเว็บเบราว์เซอร์
2. คลิกปุ่ม **"บันทึกผลผลิต"**
3. กรอกข้อมูลตามลำดับ (ระบบคำนวณทันทีขณะกรอก)

### Input Form Guide

#### **Step 1: ข้อมูลพื้นฐาน**

**วันที่เก็บเกี่ยว*** (Harvest Date)
- เลือกวันที่เก็บผลผลิต
- ตัวอย่าง: `2025-01-15`

**โรงเรือน*** (Greenhouse)
- เลือกจาก dropdown: โรงปลูกที่ 1, 2, 3

#### **Step 2: ข้อมูลถาดและพื้นที่**

**ประเภทถาด*** (Tray Type)
- เลือกจาก dropdown:
  - `Hydroponic Tray 112×65 cm` (0.73 ตร.ม., 24 หลุม)
  - `Hydroponic Tray 2m NFT/DFT` (2.66 ตร.ม., 100 หลุม)
  - `Ebb & Flow Tray 2m` (2.60 ตร.ม., 100 หลุม)

**จำนวนถาด*** (Tray Count)
- ระบุจำนวนถาดรวมทั้งหมดที่เก็บเกี่ยว
- ตัวอย่าง: `30` หมายถึง เก็บเกี่ยว 30 ถาด

**การคำนวณอัตโนมัติ:**
```
พื้นที่รวม = จำนวนถาด × พื้นที่ต่อถาด
ตัวอย่าง: 30 ถาด × 2.66 ตร.ม. = 79.80 ตร.ม.

จำนวนหลุมรวม = จำนวนถาด × หลุมต่อถาด
ตัวอย่าง: 30 ถาด × 100 หลุม = 3,000 หลุม
```

**☑ ปลูกเต็มหลุม** (Full Holes Checkbox)
- **Default: ✓ checked** (กรณีที่พบบ่อยที่สุด - ปลูกเต็มหลุม)
- **ถ้า checked**: ใช้หลุมเต็มทุกหลุม → พื้นที่จริง = พื้นที่รวม
- **ถ้า unchecked**: แสดงช่องกรอก "จำนวนหลุมที่ใช้"

**จำนวนหลุมที่ใช้** (Holes Used - ปรากฏเมื่อ uncheck)
- ระบุจำนวนหลุมที่ปลูกจริง (ถ้าไม่เต็มหลุม)
- ตัวอย่าง: กรอก `2400` หมายถึง ปลูก 2,400 หลุม จาก 3,000 หลุม

**การคำนวณพื้นที่จริง:**
```
ถ้า checked "ปลูกเต็มหลุม":
  พื้นที่จริง = พื้นที่รวม
  ตัวอย่าง: 79.80 ตร.ม. (เต็มหลุม)

ถ้า unchecked และระบุหลุมที่ใช้:
  พื้นที่จริง = (หลุมที่ใช้ / หลุมรวม) × พื้นที่รวม
  ตัวอย่าง: (2400 / 3000) × 79.80 = 63.84 ตร.ม. (80%)
```

#### **Step 3: ข้อมูลผลผลิต**

**ชนิดผัก*** (Vegetable Type)
- เลือกจาก dropdown: ผักกาดหอม, คะน้า, ผักโขม, โหระพา

**น้ำหนักที่เก็บได้ (kg)*** (Harvest Weight)
- ระบุน้ำหนักผลผลิตรวมที่เก็บได้
- ตัวอย่าง: `125.5` (kg)

**วันที่เริ่มปลูก*** (Plant Date)
- เลือกวันที่ transplant หรือเริ่มปลูก
- ตัวอย่าง: `2024-12-15`

**การคำนวณจำนวนวันปลูก:**
```
จำนวนวันปลูก = วันเก็บเกี่ยว - วันเริ่มปลูก
ตัวอย่าง: 2025-01-15 - 2024-12-15 = 31 วัน
```

#### **Step 4: ประมาณการพลังงาน (Auto-calculated)**

เมื่อกรอกข้อมูลครบ ระบบจะแสดงกล่องสีเหลือง **"ประมาณการพลังงาน"** อัตโนมัติ:

**จำนวนวันปลูก**
```
= วันเก็บเกี่ยว - วันเริ่มปลูก
ตัวอย่าง: 31 วัน
```

**ใช้ไฟรวม (kWh)**
```
= พื้นที่จริง × จำนวนวันปลูก × อัตราพลังงาน
= 63.84 ตร.ม. × 31 วัน × 2.8 kWh/ตร.ม./วัน
= 5,543.23 kWh
```

**ประสิทธิภาพ (kWh/kg)**
```
= ใช้ไฟรวม / น้ำหนักผลผลิต
= 5,543.23 kWh / 125.5 kg
= 44.17 kWh/kg
(หมายถึง: ใช้ไฟ 44.17 หน่วย เพื่อผลิตผัก 1 kg)
```

**ผลผลิตต่อหน่วย (kg/kWh)**
```
= น้ำหนักผลผลิต / ใช้ไฟรวม
= 125.5 kg / 5,543.23 kWh
= 0.023 kg/kWh
(หมายถึง: ใช้ไฟ 1 หน่วย ได้ผัก 0.023 kg)
```

### Example: Complete Input

**ตัวอย่างที่ 1: ปลูกเต็มหลุม**
```
วันที่เก็บเกี่ยว: 2025-01-15
โรงเรือน: โรงปลูกที่ 1

ประเภทถาด: Hydroponic Tray 2m NFT/DFT (2.66 ตร.ม., 100 หลุม)
จำนวนถาด: 30                  → พื้นที่รวม: 79.80 ตร.ม.
                              → หลุมรวม: 3,000 หลุม

☑ ปลูกเต็มหลุม               → พื้นที่จริง: 79.80 ตร.ม. (เต็มหลุม)

ชนิดผัก: ผักกาดหอม
น้ำหนัก: 125.5 kg
วันที่เริ่มปลูก: 2024-12-15   → จำนวนวัน: 31 วัน

--- ประมาณการพลังงาน ---
จำนวนวันปลูก: 31 วัน
ใช้ไฟรวม: 6,929.04 kWh
ประสิทธิภาพ: 55.21 kWh/kg
ผลผลิตต่อหน่วย: 0.018 kg/kWh
```

**ตัวอย่างที่ 2: ปลูกไม่เต็มหลุม (Partial)**
```
วันที่เก็บเกี่ยว: 2025-01-15
โรงเรือน: โรงปลูกที่ 2

ประเภทถาด: Hydroponic Tray 112×65 cm (0.73 ตร.ม., 24 หลุม)
จำนวนถาด: 30                  → พื้นที่รวม: 21.90 ตร.ม.
                              → หลุมรวม: 720 หลุม

☐ ปลูกเต็มหลุม (unchecked)
จำนวนหลุมที่ใช้: 600          → พื้นที่จริง: 18.25 ตร.ม. (600 หลุม / 83.3%)

ชนิดผัก: ผักโขม
น้ำหนัก: 45.8 kg
วันที่เริ่มปลูก: 2024-12-20   → จำนวนวัน: 26 วัน

--- ประมาณการพลังงาน ---
จำนวนวันปลูก: 26 วัน
ใช้ไฟรวม: 1,328.20 kWh
ประสิทธิภาพ: 29.00 kWh/kg
ผลผลิตต่อหน่วย: 0.034 kg/kWh
```

### Tips

- ✅ **Real-time calculation**: ตัวเลขจะอัปเดตทันทีขณะพิมพ์
- ✅ **Simplified input**: กรอกเฉพาะจำนวนถาดโดยตรง ไม่ต้องคำนวณซับซ้อน
- ✅ **Smart checkbox**: default เป็น "ปลูกเต็มหลุม" ซึ่งเป็นกรณีที่พบบ่อยที่สุด
- ✅ **Proportional area**: ระบบคำนวณพื้นที่จริงตามสัดส่วนหลุมที่ใช้อัตโนมัติ
- ✅ **Energy preview**: เช็คตัวเลขก่อนกด "บันทึก" เพื่อความแม่นยำ

## Author

Civic AgroTech Development Team

## Version

v1.0 - Prototype Phase (Ideas v2)
